import{c as bt,a as c,f as m,e as u,r as Ca,t as La}from"../chunks/Bgrwumxt.js";import"../chunks/DhE9Dmh7.js";import{p as At,i as ra,f as st,a as Bt,s as r,c as i,r as e,t as ot,d as t,o as Ma,l as q,b as $a,m as v,e as o,g as yt,n as sa,h as ia}from"../chunks/BITUO3ds.js";import{s as P}from"../chunks/OzCop-J-.js";import{i as w}from"../chunks/BH6CHFx5.js";import{e as dt,i as lt}from"../chunks/BVTScTTu.js";import{b as Rt}from"../chunks/D4bh5b3p.js";import{i as Ot}from"../chunks/DYcduxHM.js";import{s as Da,a as jt}from"../chunks/BxqH717Y.js";import{p as Sa}from"../chunks/BuXC-ivL.js";import{g as Q}from"../chunks/CQtkROrR.js";import{p as T}from"../chunks/KPTtVCqv.js";import{c as Ha,m as Ea}from"../chunks/CBoHnL1w.js";import{i as Na}from"../chunks/B94qQf-I.js";import{H as xt}from"../chunks/BDVFZ8Lf.js";import{r as na}from"../chunks/CGMmQ8Nh.js";import{p as ct}from"../chunks/CQCJQAaV.js";import{L as ja}from"../chunks/DBq5NF87.js";var Aa=m('<li class="list-group-item d-flex justify-content-between align-items-center"><div><strong> </strong><br/> <small> </small></div> <button class="btn btn-sm btn-outline-primary">Link</button></li>'),Ba=m('<ul class="list-group"></ul>'),Ra=m('<p class="text-muted">No matching impacts found.</p>'),Oa=m('<div class="modal-backdrop fade show"></div> <div class="modal d-block" tabindex="-1"><div class="modal-dialog modal-lg"><div class="modal-content"><div class="modal-header"><h5 class="modal-title">Link Existing Impact</h5> <button type="button" class="btn-close"></button></div> <div class="modal-body"><input type="text" class="form-control mb-3" placeholder="Search impacts..."/> <!></div> <div class="modal-footer"><button class="btn btn-secondary">Close</button></div></div></div></div>',1);function qa(ut,I){At(I,!1);let V=ct(I,"show",8,!1),X=ct(I,"impacts",24,()=>[]),C=ct(I,"search",12,"");const _=ra();function L(h){_("link",h)}function z(){_("close")}Ot();var Y=bt(),Z=st(Y);{var tt=h=>{var H=Oa(),U=r(st(H),2),E=i(U),W=i(E),n=i(W),N=r(i(n),2);e(n);var l=r(n,2),x=i(l);na(x);var F=r(x,2);{var G=g=>{var k=Ba();dt(k,5,X,lt,(j,b)=>{var y=Aa(),A=i(y),at=i(A),vt=i(at,!0);e(at);var ft=r(at,3),It=i(ft);e(ft),e(A);var zt=r(A,2);e(y),ot(()=>{P(vt,t(b).description),P(It,`Likelihood: ${t(b).likelihood??""} | Severity: ${t(b).severity??""}`)}),u("click",zt,()=>L(t(b).id)),c(j,y)}),e(k),c(g,k)},J=(g,k)=>{{var j=b=>{var y=Ra();c(b,y)};w(g,b=>{C()&&b(j)},k)}};w(F,g=>{X().length?g(G):g(J,!1)})}e(l);var M=r(l,2),K=i(M);e(M),e(W),e(E),e(U),u("click",N,z),Rt(x,C),u("click",K,z),c(h,H)};w(Z,h=>{V()&&h(tt)})}c(ut,Y),Bt()}var Pa=m('<li class="list-group-item d-flex justify-content-between align-items-center"><div> </div> <button class="btn btn-sm btn-outline-primary">Link</button></li>'),Ua=m('<ul class="list-group"></ul>'),Wa=m('<p class="text-muted">No matching causes found.</p>'),Fa=m('<div class="modal-backdrop fade show"></div> <div class="modal d-block" tabindex="-1"><div class="modal-dialog modal-lg"><div class="modal-content"><div class="modal-header"><h5 class="modal-title">Link Existing Cause</h5> <button type="button" class="btn-close"></button></div> <div class="modal-body"><input type="text" class="form-control mb-3" placeholder="Search causes..."/> <!></div> <div class="modal-footer"><button class="btn btn-secondary">Close</button></div></div></div></div>',1);function Ga(ut,I){At(I,!1);let V=ct(I,"show",8,!1),X=ct(I,"causes",24,()=>[]),C=ct(I,"search",12,"");const _=ra();function L(h){_("link",h)}function z(){_("close")}Ot();var Y=bt(),Z=st(Y);{var tt=h=>{var H=Fa(),U=r(st(H),2),E=i(U),W=i(E),n=i(W),N=r(i(n),2);e(n);var l=r(n,2),x=i(l);na(x);var F=r(x,2);{var G=g=>{var k=Ua();dt(k,5,X,lt,(j,b)=>{var y=Pa(),A=i(y),at=i(A,!0);e(A);var vt=r(A,2);e(y),ot(()=>P(at,t(b).description)),u("click",vt,()=>L(t(b).id)),c(j,y)}),e(k),c(g,k)},J=(g,k)=>{{var j=b=>{var y=Wa();c(b,y)};w(g,b=>{C()&&b(j)},k)}};w(F,g=>{X().length?g(G):g(J,!1)})}e(l);var M=r(l,2),K=i(M);e(M),e(W),e(E),e(U),u("click",N,z),Rt(x,C),u("click",K,z),c(h,H)};w(Z,h=>{V()&&h(tt)})}c(ut,Y),Bt()}var Ja=m('<tr><td colspan="3" class="text-center text-muted">No causes added yet.</td></tr>'),Ka=m('<span class="text-muted">None</span>'),Qa=m('<tr><td> </td><td><!></td><td class="text-end"><div class="btn-group"><button class="btn btn-sm btn-outline-secondary">Edit</button> <button class="btn btn-sm btn-outline-danger">Remove</button></div></td></tr>'),Ta=m('<li class="list-group-item d-flex justify-content-between align-items-center"><span> </span> <div class="btn-group"><button class="btn btn-sm btn-outline-secondary">Edit</button> <button class="btn btn-sm btn-outline-danger">Remove</button></div></li>'),Va=m('<ul class="list-group mb-3"></ul>'),Xa=m('<p class="text-muted">No hazard-specific mitigations added.</p>'),Ya=m('<tr><td> </td><td> </td><td> </td><td class="text-end"><div class="btn-group"><button class="btn btn-sm btn-outline-secondary">Edit</button> <button class="btn btn-sm btn-outline-danger">Remove</button></div></td></tr>'),Za=m('<table class="table table-striped mb-3"><thead><tr><th>Description</th><th>Likelihood</th><th>Severity</th><th class="text-end">Actions</th></tr></thead><tbody></tbody></table>'),te=m('<p class="text-muted mb-3">No impacts added yet.</p>'),ae=m('<main class="container py-4"><button class="btn btn-link mb-3">← Back to Workspace</button> <h1 class="mb-4">Edit Hazard</h1> <div class="mb-3"><label for="hazardDescription" class="form-label">Hazard Description</label> <textarea id="hazardDescription" class="form-control" rows="4" placeholder="Describe what might go wrong"></textarea> <div class="form-text">A hazard is anything that could potentially cause harm.</div></div> <details class="card mb-3"><summary class="card-header d-flex justify-content-between align-items-center"><strong>Causes</strong> <small class="text-muted">▼</small></summary> <div class="card-body"><table class="table table-striped"><thead><tr><th>Cause</th><th>Associated Mitigations</th><th class="text-end">Actions</th></tr></thead><tbody><!></tbody></table> <button class="btn btn-outline-primary">Add New Cause</button> <button class="btn btn-outline-secondary ms-2">Link Existing Cause</button></div></details> <details class="card mb-3"><summary class="card-header d-flex justify-content-between align-items-center"><strong>Hazard-Specific Mitigations</strong> <small class="text-muted">▼</small></summary> <div class="card-body"><!> <button class="btn btn-outline-primary">Add Hazard-Specific Mitigation</button> <button class="btn btn-outline-secondary ms-2">Link Existing Mitigation</button></div></details> <details class="card mb-3"><summary class="card-header d-flex justify-content-between align-items-center"><strong>Impacts</strong> <small class="text-muted">▼</small></summary> <div class="card-body"><!> <button class="btn btn-outline-primary">Add Impact</button> <button class="btn btn-outline-secondary ms-2">Link Existing Impact</button></div></details> <button class="btn btn-success mb-4">Save Hazard</button> <!> <!> <!></main>');function ke(ut,I){var ta,aa,ea;At(I,!1);const[V,X]=Da(),C=()=>jt(Ha,"$causes",V),_=()=>jt(Ea,"$mitigations",V),L=()=>jt(Na,"$impacts",V),z=v(),Y=v(),Z=v(),tt=v(),h=v(),H=v(),U=v(),E=v(),W=v();let n=v(null),N=v(""),l=v(),x=v(!1),F=v(""),G=v(!1),J=v(""),M=v(!1),K=v(""),g=((ta=t(l))==null?void 0:ta.mitigationIds)||[],k=((aa=t(l))==null?void 0:aa.impactIds)||[],j=((ea=t(l))==null?void 0:ea.causeIds)||[];Ma(()=>{if(o(n,Sa.url.searchParams.get("id")),t(n)){const a=yt(T);o(l,a.hazards.find(s=>s.id===t(n))),console.log("Loaded hazard:",t(l)),t(l)&&o(N,t(l).description)}});function b(){Q("/workspace")}function y(a){Q(`/workspace/hazard/cause?hazardID=${t(n)}&causeID=${a}`)}function A(){pt(),Q(`/workspace/hazard/cause?hazardID=${t(n)}`)}function at(){pt(),Q(`/workspace/hazard/mitigation?hazardID=${t(n)}`)}function vt(){pt(),Q(`/workspace/hazard/impact?hazardID=${t(n)}`)}function ft(a){t(n)&&(T.update(s=>({...s,hazards:s.hazards.map(d=>{var p;return d.id===t(n)&&!((p=d.impactIds)!=null&&p.includes(a))?{...d,impactIds:[...d.impactIds||[],a]}:d})})),o(x,!1),o(l,yt(T).hazards.find(s=>s.id===t(n))))}function It(a){t(n)&&(T.update(s=>({...s,hazards:s.hazards.map(d=>{var p;return d.id===t(n)&&!((p=d.causeIds)!=null&&p.includes(a))?{...d,causeIds:[...d.causeIds||[],a]}:d})})),o(G,!1),o(l,yt(T).hazards.find(s=>s.id===t(n))))}function zt(a){It(a.detail)}function oa(a){t(n)&&(T.update(s=>({...s,hazards:s.hazards.map(d=>{var p;return d.id===t(n)&&!((p=d.mitigationIds)!=null&&p.includes(a))?{...d,mitigationIds:[...d.mitigationIds||[],a]}:d})})),o(M,!1),o(l,yt(T).hazards.find(s=>s.id===t(n))))}function da(a){oa(a.detail)}function la(a){t(n)&&o(l,xt.removeImpact(t(n),a))}function ca(a){t(n)&&o(l,xt.removeCause(t(n),a))}function ua(a){t(n)&&o(l,xt.removeHazardMitigation(t(n),a))}function va(a){ft(a.detail)}function pt(){if(!t(n)){const a=xt.saveNewHazard(t(N));o(n,a.id),o(l,a.hazardObj)}}function ma(){pt(),T.update(a=>({...a,hazards:a.hazards.map(s=>s.id===t(n)?{...s,description:t(N)}:s)})),Q("/workspace")}q(()=>(t(l),C()),()=>{var a;o(z,(((a=t(l))==null?void 0:a.causeIds)||[]).map(s=>C().find(d=>d.id===s)).filter(Boolean))}),q(()=>(t(z),_()),()=>{o(Y,t(z).flatMap(a=>a.mitigationIds||[]).map(a=>_().find(s=>s.id===a)).filter(Boolean))}),q(()=>(t(l),_()),()=>{var a;o(Z,(((a=t(l))==null?void 0:a.mitigationIds)||[]).map(s=>_().find(d=>d.id===s)).filter(Boolean))}),q(()=>L(),()=>{o(tt,L())}),q(()=>(t(tt),t(F)),()=>{o(h,t(tt).filter(a=>a.description.toLowerCase().includes(t(F).toLowerCase())&&!k.includes(a.id)))}),q(()=>C(),()=>{o(H,C())}),q(()=>(t(H),t(J)),()=>{o(U,t(H).filter(a=>a.description.toLowerCase().includes(t(J).toLowerCase())&&!j.includes(a.id)))}),q(()=>_(),()=>{o(E,_())}),q(()=>(t(E),t(K)),()=>{o(W,t(E).filter(a=>a.description.toLowerCase().includes(t(K).toLowerCase())&&!g.includes(a.id)))}),$a(),Ot();var wt=ae(),qt=i(wt),Ct=r(qt,4),Pt=r(i(Ct),2);Ca(Pt),sa(2),e(Ct);var Lt=r(Ct,2),Ut=r(i(Lt),2),Mt=i(Ut),Wt=r(i(Mt)),ba=i(Wt);{var fa=a=>{var s=Ja();c(a,s)},pa=a=>{var s=bt(),d=st(s);dt(d,1,()=>t(z),lt,(p,f)=>{var $=Qa(),et=i($),it=i(et,!0);e(et);var D=r(et),B=i(D);{var mt=R=>{var S=bt(),ht=st(S);dt(ht,1,()=>t(f).mitigationIds,lt,(Et,O,Nt)=>{sa();var _t=La();ot(kt=>P(_t,`${kt??""}
                      ${Nt<t(f).mitigationIds.length-1?", ":""}`),[()=>{var kt;return(kt=_().find(wa=>wa.id===t(O)))==null?void 0:kt.description}],ia),c(Et,_t)}),c(R,S)},St=R=>{var S=Ka();c(R,S)};w(B,R=>{var S;(S=t(f).mitigationIds)!=null&&S.length?R(mt):R(St,!1)})}e(D);var rt=r(D),gt=i(rt),nt=i(gt),Ht=r(nt,2);e(gt),e(rt),e($),ot(()=>P(it,t(f).description)),u("click",nt,()=>y(t(f).id)),u("click",Ht,()=>ca(t(f).id)),c(p,$)}),c(a,s)};w(ba,a=>{t(z).length===0?a(fa):a(pa,!1)})}e(Wt),e(Mt);var Ft=r(Mt,2),ga=r(Ft,2);e(Ut),e(Lt);var $t=r(Lt,2),Gt=r(i($t),2),Jt=i(Gt);{var ha=a=>{var s=Va();dt(s,5,()=>t(Z),lt,(d,p)=>{var f=Ta(),$=i(f),et=i($,!0);e($);var it=r($,2),D=i(it),B=r(D,2);e(it),e(f),ot(()=>P(et,t(p).description)),u("click",D,()=>Q(`/workspace/hazard/mitigation?hazardID=${t(n)}&mitigationID=${t(p).id}`)),u("click",B,()=>ua(t(p).id)),c(d,f)}),e(s),c(a,s)},_a=a=>{var s=Xa();c(a,s)};w(Jt,a=>{t(Z).length?a(ha):a(_a,!1)})}var Kt=r(Jt,2),ka=r(Kt,2);e(Gt),e($t);var Dt=r($t,2),Qt=r(i(Dt),2),Tt=i(Qt);{var ya=a=>{var s=Za(),d=r(i(s));dt(d,5,()=>t(l).impactIds,lt,(p,f)=>{var $=bt(),et=st($);{var it=D=>{var B=Ya(),mt=i(B),St=i(mt,!0);e(mt);var rt=r(mt),gt=i(rt,!0);e(rt);var nt=r(rt),Ht=i(nt,!0);e(nt);var R=r(nt),S=i(R),ht=i(S),Et=r(ht,2);e(S),e(R),e(B),ot((O,Nt,_t)=>{P(St,O),P(gt,Nt),P(Ht,_t)},[()=>L().find(O=>O.id===t(f)).description,()=>L().find(O=>O.id===t(f)).likelihood,()=>L().find(O=>O.id===t(f)).severity],ia),u("click",ht,()=>Q(`/workspace/hazard/impact?hazardID=${t(n)}&impactID=${t(f)}`)),u("click",Et,()=>la(t(f))),c(D,B)};w(et,D=>{L().find(B=>B.id===t(f))&&D(it)})}c(p,$)}),e(d),e(s),c(a,s)},xa=a=>{var s=te();c(a,s)};w(Tt,a=>{var s,d;(d=(s=t(l))==null?void 0:s.impactIds)!=null&&d.length?a(ya):a(xa,!1)})}var Vt=r(Tt,2),Ia=r(Vt,2);e(Qt),e(Dt);var Xt=r(Dt,2),Yt=r(Xt,2);qa(Yt,{get show(){return t(x)},get impacts(){return t(h)},get search(){return t(F)},set search(a){o(F,a)},$$events:{link:va,close:()=>o(x,!1)},$$legacy:!0});var Zt=r(Yt,2);Ga(Zt,{get show(){return t(G)},get causes(){return t(U)},get search(){return t(J)},set search(a){o(J,a)},$$events:{link:zt,close:()=>o(G,!1)},$$legacy:!0});var za=r(Zt,2);ja(za,{get show(){return t(M)},get mitigations(){return t(W)},get search(){return t(K)},set search(a){o(K,a)},$$events:{link:da,close:()=>o(M,!1)},$$legacy:!0}),e(wt),u("click",qt,b),Rt(Pt,()=>t(N),a=>o(N,a)),u("click",Ft,A),u("click",ga,()=>o(G,!0)),u("click",Kt,at),u("click",ka,()=>o(M,!0)),u("click",Vt,vt),u("click",Ia,()=>o(x,!0)),u("click",Xt,ma),c(ut,wt),Bt(),X()}export{ke as component};
