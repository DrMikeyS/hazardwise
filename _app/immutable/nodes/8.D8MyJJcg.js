import{f as x,a as p,c as gt}from"../chunks/D0VXytLw.js";import"../chunks/CYFXP9DL.js";import{o as vt}from"../chunks/Z2fsJqYQ.js";import{p as bt,l as H,b as ht,t as F,g as t,a as _t,s as r,c,d as e,m as l,r as n,n as kt,f as xt,e as Mt}from"../chunks/CWAZJpex.js";import{s as L}from"../chunks/Dg_cf8a6.js";import{i as G}from"../chunks/CPB_d-hH.js";import{e as $t,i as It}from"../chunks/DPhXjgAZ.js";import{e as g,r as wt}from"../chunks/D89gcLFm.js";import{b as zt}from"../chunks/DCIzZ-IO.js";import{i as Ct}from"../chunks/Dt8oqqRZ.js";import{a as Dt,s as yt}from"../chunks/DdMTivb7.js";import{p as J}from"../chunks/DWaUOQjS.js";import{g as S}from"../chunks/DFVND9UW.js";import{g as K}from"../chunks/Doyjl1dZ.js";import{b as A}from"../chunks/DAVnRNAe.js";import{p as Lt}from"../chunks/DEmP0uQ1.js";import{c as k}from"../chunks/FIlIACWG.js";import{m as St}from"../chunks/BEGveUOT.js";import{L as At}from"../chunks/sSWP-9q0.js";var Et=x('<li class="list-group-item d-flex justify-content-between align-items-center"> <button class="btn btn-sm btn-outline-danger">Remove</button></li>'),Nt=x('<ul class="list-group mb-2"></ul>'),Bt=x('<p class="text-muted">No mitigations linked yet.</p>'),Pt=x('<main class="container py-4"><button class="btn btn-link mb-3">‚Üê Back to Hazard</button> <h1 class="mb-4"> </h1> <div class="mb-3"><label for="causeDescription" class="form-label">Cause Description</label> <textarea id="causeDescription" class="form-control" rows="3" placeholder="Describe a factor that could lead to this hazard"></textarea> <div class="form-text">A cause is a factor or condition that could contribute to the hazard occurring.</div></div> <div class="mb-4"><label class="form-label">Linked Mitigations</label> <!></div> <div class="mb-3"><button class="btn btn-secondary me-2">+ Add New Mitigation</button> <button class="btn btn-outline-primary">Link Existing Mitigation</button></div> <button class="btn btn-success"> </button> <!></main>');function ia(O,Q){bt(Q,!1);const[T,U]=Dt(),v=()=>yt(St,"$mitigations",T),M=l(),E=l();let m=null,s=l(null),u=l(""),o=l([]),b=l(!1),h=l("");vt(()=>{if(m=J.url.searchParams.get("hazardID"),e(s,J.url.searchParams.get("causeID")),t(s)){const a=K(k).find(i=>i.id===t(s));a&&(e(u,a.description),e(o,a.mitigationIds||[]))}});function V(){S(A+`/workspace/hazard?id=${m}`)}function W(){k.update(a=>a.map(i=>i.id===t(s)?{...i,description:t(u),mitigationIds:t(o)}:i))}function X(){const a=K(k).length+1;e(s,`C${String(a).padStart(2,"0")}`),k.update(i=>[...i,{id:t(s),description:t(u),mitigationIds:t(o)}]),Lt.update(i=>({...i,hazards:i.hazards.map(d=>d.id===m?{...d,causeIds:[...d.causeIds||[],t(s)]}:d)}))}function N(){t(s)?W():X()}function Y(){N(),S(A+`/workspace/hazard?id=${m}`)}function Z(a){e(o,[...t(o),a])}function tt(a){e(o,t(o).filter(i=>i!==a))}function at(){N(),S(A+`/workspace/hazard/mitigation?causeID=${t(s)}&hazardID=${m}`)}function it(a){Z(a.detail),e(b,!1)}H(()=>v(),()=>{e(M,v())}),H(()=>(t(M),t(h),t(o)),()=>{e(E,t(M).filter(a=>a.description.toLowerCase().includes(t(h).toLowerCase())&&!t(o).includes(a.id)))}),ht(),Ct();var $=Pt(),B=c($),I=r(B,2),et=c(I,!0);n(I);var w=r(I,2),P=r(c(w),2);wt(P),kt(2),n(w);var z=r(w,2),st=r(c(z),2);{var ot=a=>{var i=Nt();$t(i,5,()=>t(o),It,(d,D)=>{var j=gt(),dt=xt(j);{var mt=y=>{var f=Et();const ut=Mt(()=>v().find(pt=>pt.id===t(D)));var q=c(f),ft=r(q);n(f),F(()=>L(q,`${t(ut).description??""} `)),g("click",ft,()=>tt(t(D))),p(y,f)};G(dt,y=>{v().find(f=>f.id===t(D))&&y(mt)})}p(d,j)}),n(i),p(a,i)},rt=a=>{var i=Bt();p(a,i)};G(st,a=>{t(o).length?a(ot):a(rt,!1)})}n(z);var C=r(z,2),R=c(C),nt=r(R,2);n(C);var _=r(C,2),ct=c(_,!0);n(_);var lt=r(_,2);At(lt,{get show(){return t(b)},get mitigations(){return t(E)},get search(){return t(h)},set search(a){e(h,a)},$$events:{link:it,close:()=>e(b,!1)},$$legacy:!0}),n($),F(()=>{L(et,t(s)?"Edit Cause":"Add Cause"),L(ct,t(s)?"Save Changes":"Save Cause")}),g("click",B,V),zt(P,()=>t(u),a=>e(u,a)),g("click",R,at),g("click",nt,()=>e(b,!0)),g("click",_,Y),p(O,$),_t(),U()}export{ia as component};
