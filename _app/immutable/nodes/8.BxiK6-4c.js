import{c as Mt,a as v,f,t as Ya}from"../chunks/EuKFVhsR.js";import"../chunks/CjrjPegm.js";import{p as St,f as lt,a as $t,s as i,c as s,r as e,t as st,g as t,d as r,m as u,l as F,h as Da,n as Ca,i as ea}from"../chunks/DIjqGaOE.js";import{s as H}from"../chunks/DSOjtZ6D.js";import{i as U}from"../chunks/CQyKFiTL.js";import{e as mt,i as bt}from"../chunks/DmmqpXdj.js";import{e as b,r as ra}from"../chunks/DDm2SC16.js";import{s as Ut}from"../chunks/DDsT7xP8.js";import{b as Et,a as Ma}from"../chunks/fMvjHjjw.js";import{i as jt}from"../chunks/B7ev73gN.js";import{s as Za,a as Dt}from"../chunks/CxKmxjN7.js";import{p as te}from"../chunks/Dmjut8aZ.js";import{g as ft}from"../chunks/Dkv_9hRV.js";import{b as gt}from"../chunks/ahzJhC7E.js";import{g as oa}from"../chunks/D-P7AXKl.js";import{p as ut}from"../chunks/Bu9f80X6.js";import{c as ae}from"../chunks/CVsMCqo-.js";import{m as ee}from"../chunks/HCEeGut2.js";import{i as Ot}from"../chunks/Bj2ds-qs.js";import{H as sa}from"../chunks/B061VnbM.js";import{c as qt,o as La}from"../chunks/fqUTzOFw.js";import{r as Lt,b as se}from"../chunks/B8I-ELwR.js";import{p as ct}from"../chunks/DRyE_Ojy.js";import{L as ie}from"../chunks/CdLx_qlF.js";import{c as Sa}from"../chunks/i5w7oQmI.js";import{D as ia}from"../chunks/CrXWVPai.js";var re=f('<li class="list-group-item d-flex justify-content-between align-items-center"><div><strong> </strong><br/> <small> </small></div> <button class="btn btn-sm btn-outline-primary">Link</button></li>'),oe=f('<ul class="list-group"></ul>'),ne=f('<p class="text-muted">No matching impacts found.</p>'),le=f('<div class="modal-backdrop fade show"></div> <div class="modal d-block" tabindex="-1"><div class="modal-dialog modal-lg"><div class="modal-content"><div class="modal-header"><h5 class="modal-title">Link Existing Impact</h5> <button type="button" class="btn-close"></button></div> <div class="modal-body"><input type="text" class="form-control mb-3" placeholder="Search impacts..."/> <!></div> <div class="modal-footer"><button class="btn btn-secondary">Close</button></div></div></div></div>',1);function ce(ot,w){St(w,!1);let G=ct(w,"show",8,!1),z=ct(w,"impacts",24,()=>[]),J=ct(w,"search",12,"");const E=qt();function I(m){E("link",m)}function C(){E("close")}jt();var B=Mt(),o=lt(B);{var d=m=>{var X=le(),O=i(lt(X),2),N=s(O),K=s(N),D=s(K),Q=i(s(D),2);e(D);var L=i(D,2),j=s(L);Lt(j);var A=i(j,2);{var T=c=>{var g=oe();mt(g,5,z,bt,(S,p)=>{var M=re(),$=s(M),q=s($),W=s(q,!0);e(q);var it=i(q,3),k=s(it);e(it),e($);var _=i($,2);e(M),st(()=>{H(W,t(p).description),H(k,`Likelihood: ${t(p).likelihood??""} | Severity: ${t(p).severity??""}`)}),b("click",_,()=>I(t(p).id)),v(S,M)}),e(g),v(c,g)},P=(c,g)=>{{var S=p=>{var M=ne();v(p,M)};U(c,p=>{J()&&p(S)},g)}};U(A,c=>{z().length?c(T):c(P,!1)})}e(L);var R=i(L,2),y=s(R);e(R),e(K),e(N),e(O),b("click",Q,C),Et(j,J),b("click",y,C),v(m,X)};U(o,m=>{G()&&m(d)})}v(ot,B),$t()}var de=f('<li class="list-group-item d-flex justify-content-between align-items-center"><div> </div> <button class="btn btn-sm btn-outline-primary">Link</button></li>'),ve=f('<ul class="list-group"></ul>'),ue=f('<p class="text-muted">No matching causes found.</p>'),me=f('<div class="modal-backdrop fade show"></div> <div class="modal d-block" tabindex="-1"><div class="modal-dialog modal-lg"><div class="modal-content"><div class="modal-header"><h5 class="modal-title">Link Existing Cause</h5> <button type="button" class="btn-close"></button></div> <div class="modal-body"><input type="text" class="form-control mb-3" placeholder="Search causes..."/> <!></div> <div class="modal-footer"><button class="btn btn-secondary">Close</button></div></div></div></div>',1);function be(ot,w){St(w,!1);let G=ct(w,"show",8,!1),z=ct(w,"causes",24,()=>[]),J=ct(w,"search",12,"");const E=qt();function I(m){E("link",m)}function C(){E("close")}jt();var B=Mt(),o=lt(B);{var d=m=>{var X=me(),O=i(lt(X),2),N=s(O),K=s(N),D=s(K),Q=i(s(D),2);e(D);var L=i(D,2),j=s(L);Lt(j);var A=i(j,2);{var T=c=>{var g=ve();mt(g,5,z,bt,(S,p)=>{var M=de(),$=s(M),q=s($,!0);e($);var W=i($,2);e(M),st(()=>H(q,t(p).description)),b("click",W,()=>I(t(p).id)),v(S,M)}),e(g),v(c,g)},P=(c,g)=>{{var S=p=>{var M=ue();v(p,M)};U(c,p=>{J()&&p(S)},g)}};U(A,c=>{z().length?c(T):c(P,!1)})}e(L);var R=i(L,2),y=s(R);e(R),e(K),e(N),e(O),b("click",Q,C),Et(j,J),b("click",y,C),v(m,X)};U(o,m=>{G()&&m(d)})}v(ot,B),$t()}var pe=f('<tr><td class="text-nowrap"><input type="radio" name="likelihood" class="form-check-input me-2"/> <strong> </strong></td><td> </td></tr>'),fe=f('<div class="mb-3"><label class="form-label">Risk Rating</label> <div class="d-flex align-items-center"><span> </span> <small> </small></div></div>'),ge=f('<div class="modal-backdrop fade show"></div> <div class="modal fade show" tabindex="-1" style="display: block;"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><h5 class="modal-title">Assess Impact</h5> <button type="button" class="btn-close" aria-label="Close"></button></div> <div class="modal-body"><div class="mb-3"><label class="form-label">Impact Description</label> <textarea class="form-control" rows="2" disabled></textarea></div> <div class="mb-3"><label class="form-label">Severity</label> <input class="form-control" disabled/></div> <div class="mb-3"></div> <label class="form-label">Likelihood</label> <p>How likely is it that this impact will occur <strong>due to this hazard</strong> and <strong>with the planned mitigations</strong> in place?</p> <table class="table table-bordered align-middle"><tbody></tbody></table> <!></div> <div class="modal-footer"><button type="button" class="btn btn-secondary">Cancel</button> <button type="button" class="btn btn-primary">Save</button></div></div></div></div>',1);function he(ot,w){St(w,!1);const G=u(),z=u(),J=[];let E=ct(w,"hazardID",8),I=ct(w,"impactID",8);const C=qt();let B=u(""),o=u(""),d=u("");La(()=>{const k=oa(Ot).find(_=>_.id===I());k&&(r(B,k.description),r(o,k.severity))});const m={Catastrophic:5,Major:4,Considerable:3,Significant:2,Minor:1,"Almost Certain":5,Likely:4,Possible:3,Unlikely:2,Rare:1},X={1:"bg-success text-white",2:"bg-info text-dark",3:"bg-warning text-dark",4:"bg-danger text-white",5:"bg-danger text-white"},O=[{value:"Almost Certain",label:"Almost Certain",description:"Expected to occur frequently",class:"table-danger"},{value:"Likely",label:"Likely",description:"Will probably occur occasionally",class:"table-warning"},{value:"Possible",label:"Possible",description:"Could occur but uncommon",class:"table-info"},{value:"Unlikely",label:"Unlikely",description:"Rare but possible",class:""},{value:"Rare",label:"Rare",description:"Exceptional circumstances only",class:"table-secondary text-white"}];function N(){if(!t(d)){alert("Please select a likelihood.");return}ut.update(k=>({...k,hazards:k.hazards.map(_=>{var Y;if(_.id!==E())return _;const at=(Y=_.hazardImpacts)==null?void 0:Y.some(Z=>Z.impactID===I()),V={impactID:I(),likelihood:t(d)};return{..._,hazardImpacts:at?_.hazardImpacts.map(Z=>Z.impactID===I()?V:Z):[..._.hazardImpacts||[],V]}})})),C("save")}function K(){C("cancel")}F(()=>(t(o),t(d)),()=>{r(G,(m[t(o)]||0)*(m[t(d)]||0))}),F(()=>(t(o),t(d),ia),()=>{r(z,m[t(o)]&&m[t(d)]?ia.assess(m[t(d)],m[t(o)]):null)}),Da(),jt();var D=ge(),Q=i(lt(D),2),L=s(Q),j=s(L),A=s(j),T=i(s(A),2);e(A);var P=i(A,2),R=s(P),y=i(s(R),2);ra(y),e(R);var c=i(R,2),g=i(s(c),2);Lt(g),e(c);var S=i(c,8),p=s(S);mt(p,5,()=>O,bt,(k,_)=>{var at=pe(),V=s(at),Y=s(V);Lt(Y);var Z,ht=i(Y,2),Wt=s(ht,!0);e(ht),e(V);var At=i(V),Ft=s(At,!0);e(At),e(at),st(()=>{Ut(at,1,Sa(t(_).class)),Z!==(Z=t(_).value)&&(Y.value=(Y.__value=t(_).value)??""),H(Wt,t(_).label),H(Ft,t(_).description)}),Ma(J,[],Y,()=>(t(_).value,t(d)),Gt=>r(d,Gt)),v(k,at)}),e(p),e(S);var M=i(S,2);{var $=k=>{var _=fe(),at=i(s(_),2),V=s(at),Y=s(V,!0);e(V);var Z=i(V,2),ht=s(Z);e(Z),e(at),e(_),st(()=>{Ut(V,1,`badge ${X[t(z).score]} me-2`),H(Y,t(z).rating),H(ht,`${t(z).definition??""} (Score: ${t(z).score??""})`)}),v(k,_)};U(M,k=>{t(z)&&k($)})}e(P);var q=i(P,2),W=s(q),it=i(W,2);e(q),e(j),e(L),e(Q),st(()=>se(g,t(o))),b("click",T,K),Et(y,()=>t(B),k=>r(B,k)),b("click",W,K),b("click",it,N),v(ot,D),$t()}var _e=f('<tr><td class="text-nowrap"><input type="radio" name="impactSeverity" class="form-check-input me-2"/> <strong> </strong></td><td> </td></tr>'),ye=f('<div class="modal-backdrop fade show"></div> <div class="modal fade show" tabindex="-1" style="display: block;"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><h5 class="modal-title">Edit Impact</h5> <button type="button" class="btn-close" aria-label="Close"></button></div> <div class="modal-body"><div class="mb-3"><label for="impactDescription" class="form-label">Description</label> <textarea id="impactDescription" class="form-control" rows="3"></textarea></div> <h5 class="mt-4">Severity</h5> <p>How badly could someone (or some people) be hurt if this impact occurred?</p> <table class="table table-bordered align-middle"><tbody></tbody></table></div> <div class="modal-footer"><button type="button" class="btn btn-secondary">Cancel</button> <button type="button" class="btn btn-primary">Save</button></div></div></div></div>',1);function ke(ot,w){St(w,!1);const G=[];let z=ct(w,"impactID",8);const J=qt();let E=u(""),I=u("");const C=[{value:"Catastrophic",label:"Catastrophic",description:"Death; permanent life-changing incapacity; or severe injury/incapacity from which recovery is not expected in the short term. [Multiple patients]",class:"table-danger"},{value:"Major",label:"Major",description:"[Single patient:] death or permanent life-changing incapacity not recoverable. [Multiple patients:] severe injury/incapacity recoverable; severe psychological trauma.",class:"table-warning"},{value:"Considerable",label:"Considerable",description:"Severe injury/incapacity from which recovery is expected in the short term; severe psychological trauma. [Single or multiple patients]",class:"table-info"},{value:"Significant",label:"Significant",description:"Minor injury or injuries from which recovery is not expected in the short term; significant psychological trauma. [Single or multiple patients]",class:""},{value:"Minor",label:"Minor",description:"Minor injury from which recovery is expected in the short term; minor psychological upset or inconvenience. [Single or multiple patients]",class:"table-secondary text-white"}];La(()=>{const y=oa(Ot).find(c=>c.id===z());y&&(r(E,y.description),r(I,y.severity))});function B(){Ot.update(y=>y.map(c=>c.id===z()?{...c,description:t(E),severity:t(I)}:c)),J("save",{impactID:z(),description:t(E),severity:t(I)})}function o(){J("cancel")}jt();var d=ye(),m=i(lt(d),2),X=s(m),O=s(X),N=s(O),K=i(s(N),2);e(N);var D=i(N,2),Q=s(D),L=i(s(Q),2);ra(L),e(Q);var j=i(Q,6),A=s(j);mt(A,5,()=>C,bt,(y,c)=>{var g=_e(),S=s(g),p=s(S);Lt(p);var M,$=i(p,2),q=s($,!0);e($),e(S);var W=i(S),it=s(W,!0);e(W),e(g),st(()=>{Ut(g,1,Sa(t(c).class)),M!==(M=t(c).value)&&(p.value=(p.__value=t(c).value)??""),H(q,t(c).label),H(it,t(c).description)}),Ma(G,[],p,()=>(t(c).value,t(I)),k=>r(I,k)),v(y,g)}),e(A),e(j),e(D);var T=i(D,2),P=s(T),R=i(P,2);e(T),e(O),e(X),e(m),b("click",K,o),Et(L,()=>t(E),y=>r(E,y)),b("click",P,o),b("click",R,B),v(ot,d),$t()}var xe=f('<tr><td colspan="3" class="text-center text-muted">No causes added yet.</td></tr>'),Ie=f('<span class="text-muted">None</span>'),we=f('<tr><td> </td><td><!></td><td class="text-end"><div class="btn-group"><button class="btn btn-sm btn-outline-secondary">Edit</button> <button class="btn btn-sm btn-outline-danger">Remove</button></div></td></tr>'),ze=f('<li class="list-group-item d-flex justify-content-between align-items-center"><span> </span> <div class="btn-group"><button class="btn btn-sm btn-outline-secondary">Edit</button> <button class="btn btn-sm btn-outline-danger">Remove</button></div></li>'),Ce=f('<ul class="list-group mb-3"></ul>'),De=f('<p class="text-muted">No hazard-specific mitigations added.</p>'),Me=f("<span> </span>"),Le=f('<span class="text-muted">Unassessed</span>'),Se=f('<tr><td> </td><td> </td><td> </td><td><!></td><td class="text-end"><div class="btn-group"><button class="btn btn-sm btn-outline-secondary">Edit</button> <button class="btn btn-sm btn-outline-primary">Assess Likelihood</button> <button class="btn btn-sm btn-outline-danger">Remove</button></div></td></tr>'),$e=f('<table class="table table-striped mb-3"><thead><tr><th>Description</th><th>Likelihood</th><th>Severity</th><th>Risk Rating</th><th class="text-end">Actions</th></tr></thead><tbody></tbody></table>'),Ee=f('<p class="text-muted mb-3">No impacts added yet.</p>'),je=f('<main class="container py-4"><button class="btn btn-link mb-3">← Back to Workspace</button> <h1 class="mb-4">Add/Edit Hazard</h1> <div class="mb-3"><label for="hazardDescription" class="form-label">Hazard Description</label> <textarea id="hazardDescription" class="form-control" rows="4" placeholder="Describe what might go wrong"></textarea> <div class="form-text">A hazard is anything that could potentially cause harm.</div></div> <details class="card mb-3"><summary class="card-header d-flex justify-content-between align-items-center"><strong>Causes</strong> <small class="text-muted">▼</small></summary> <div class="card-body"><table class="table table-striped"><thead><tr><th>Cause</th><th>Associated Mitigations</th><th class="text-end">Actions</th></tr></thead><tbody><!></tbody></table> <button class="btn btn-outline-primary">Add New Cause</button> <button class="btn btn-outline-secondary ms-2">Link Existing Cause</button></div></details> <details class="card mb-3"><summary class="card-header d-flex justify-content-between align-items-center"><strong>Hazard-Specific Mitigations</strong> <small class="text-muted">▼</small></summary> <div class="card-body"><!> <button class="btn btn-outline-primary">Add Hazard-Specific Mitigation</button> <button class="btn btn-outline-secondary ms-2">Link Existing Mitigation</button></div></details> <details class="card mb-3"><summary class="card-header d-flex justify-content-between align-items-center"><strong>Impacts</strong> <small class="text-muted">▼</small></summary> <div class="card-body"><!> <button class="btn btn-outline-primary">Add Impact</button> <button class="btn btn-outline-secondary ms-2">Link Existing Impact</button></div></details> <button class="btn btn-success mb-4">Save Hazard</button> <!> <!> <!> <!> <!></main>');function os(ot,w){var Ia,wa,za;St(w,!1);const[G,z]=Za(),J=()=>Dt(te,"$page",G),E=()=>Dt(ut,"$project",G),I=()=>Dt(ae,"$causes",G),C=()=>Dt(ee,"$mitigations",G),B=()=>Dt(Ot,"$impacts",G),o=u(),d=u(),m=u(),X=u(),O=u(),N=u(),K=u(),D=u(),Q=u(),L=u(),j=u();let A=u(""),T=u(!1),P=u(""),R=u(!1),y=u(""),c=u(!1),g=u(""),S=((Ia=t(d))==null?void 0:Ia.mitigationIds)||[],p=((wa=t(d))==null?void 0:wa.impactIds)||[],M=((za=t(d))==null?void 0:za.causeIds)||[],$=u(!1),q=u(null),W=u(!1),it=u(null);const k={Catastrophic:5,Major:4,Considerable:3,Significant:2,Minor:1,"Almost Certain":5,Likely:4,Possible:3,Unlikely:2,Rare:1},_={1:"bg-success text-white",2:"bg-info text-dark",3:"bg-warning text-dark",4:"bg-danger text-white",5:"bg-danger text-white"};function at(){ft(gt+"/workspace")}function V(a){ft(gt+`/workspace/hazard/cause?hazardID=${t(o)}&causeID=${a}`)}function Y(){Rt(),ft(gt+`/workspace/hazard/cause?hazardID=${t(o)}`)}function Z(){Rt(),ft(gt+`/workspace/hazard/mitigation?hazardID=${t(o)}`)}function ht(){Rt(),ft(gt+`/workspace/hazard/impact?hazardID=${t(o)}`)}function Wt(a){t(o)&&(ut.update(n=>({...n,hazards:n.hazards.map(l=>{var h;return l.id!==t(o)||((h=l.hazardImpacts)==null?void 0:h.some(tt=>tt.impactID===a))?l:{...l,hazardImpacts:[...l.hazardImpacts||[],{impactID:a}]}})})),r(T,!1))}function At(a){t(o)&&(ut.update(n=>({...n,hazards:n.hazards.map(l=>{var x;return l.id===t(o)&&!((x=l.causeIds)!=null&&x.includes(a))?{...l,causeIds:[...l.causeIds||[],a]}:l})})),r(R,!1))}function Ft(a){At(a.detail)}function Gt(a){t(o)&&(ut.update(n=>({...n,hazards:n.hazards.map(l=>{var x;return l.id===t(o)&&!((x=l.mitigationIds)!=null&&x.includes(a))?{...l,mitigationIds:[...l.mitigationIds||[],a]}:l})})),r(c,!1))}function $a(a){Gt(a.detail)}function Ea(a){if(!t(o))return;ut.update(l=>({...l,hazards:l.hazards.map(x=>x.id===t(o)?{...x,hazardImpacts:x.hazardImpacts?x.hazardImpacts.filter(h=>h.impactID!==a):[]}:x)}));const n=oa(ut).hazards.find(l=>l.id===t(o));n&&r(d,n)}function ja(a){t(o)&&r(d,sa.removeCause(t(o),a))}function Aa(a){t(o)&&r(d,sa.removeHazardMitigation(t(o),a))}function Ra(a){Wt(a.detail)}function Rt(){if(!t(o)){const a=sa.saveNewHazard(t(A));r(o,a.id),r(d,a.hazardObj)}}function Ha(){Rt(),ut.update(a=>({...a,hazards:a.hazards.map(n=>n.id===t(o)?{...n,description:t(A)}:n)})),ft(gt+"/workspace/hazards")}F(()=>J(),()=>{r(o,J().url.searchParams.get("id"))}),F(()=>(t(o),E()),()=>{r(d,t(o)?E().hazards.find(a=>a.id===t(o)):null)}),F(()=>t(d),()=>{t(d)&&r(A,t(d).description)}),F(()=>(t(d),I()),()=>{var a;r(m,(((a=t(d))==null?void 0:a.causeIds)||[]).map(n=>I().find(l=>l.id===n)).filter(Boolean))}),F(()=>(t(m),C()),()=>{r(X,t(m).flatMap(a=>a.mitigationIds||[]).map(a=>C().find(n=>n.id===a)).filter(Boolean))}),F(()=>(t(d),C()),()=>{var a;r(O,(((a=t(d))==null?void 0:a.mitigationIds)||[]).map(n=>C().find(l=>l.id===n)).filter(Boolean))}),F(()=>B(),()=>{r(N,B())}),F(()=>(t(N),t(P)),()=>{r(K,t(N).filter(a=>a.description.toLowerCase().includes(t(P).toLowerCase())&&!p.includes(a.id)))}),F(()=>I(),()=>{r(D,I())}),F(()=>(t(D),t(y)),()=>{r(Q,t(D).filter(a=>a.description.toLowerCase().includes(t(y).toLowerCase())&&!M.includes(a.id)))}),F(()=>C(),()=>{r(L,C())}),F(()=>(t(L),t(g)),()=>{r(j,t(L).filter(a=>a.description.toLowerCase().includes(t(g).toLowerCase())&&!S.includes(a.id)))}),Da(),jt();var Jt=je(),na=s(Jt),Kt=i(na,4),la=i(s(Kt),2);ra(la),Ca(2),e(Kt);var Qt=i(Kt,2),ca=i(s(Qt),2),Tt=s(ca),da=i(s(Tt)),Ba=s(da);{var Na=a=>{var n=xe();v(a,n)},Pa=a=>{var n=Mt(),l=lt(n);mt(l,1,()=>t(m),bt,(x,h)=>{var tt=we(),rt=s(tt),_t=s(rt,!0);e(rt);var dt=i(rt),nt=s(dt);{var It=vt=>{var et=Mt(),Yt=lt(et);mt(Yt,1,()=>t(h).mitigationIds,bt,(Zt,ta,Nt)=>{Ca();var Ct=Ya();st(pt=>H(Ct,`${pt??""}
                      ${Nt<t(h).mitigationIds.length-1?", ":""}`),[()=>{var pt;return(pt=C().find(Pt=>Pt.id===t(ta)))==null?void 0:pt.description}],ea),v(Zt,Ct)}),v(vt,et)},wt=vt=>{var et=Ie();v(vt,et)};U(nt,vt=>{var et;(et=t(h).mitigationIds)!=null&&et.length?vt(It):vt(wt,!1)})}e(dt);var Ht=i(dt),yt=s(Ht),Bt=s(yt),zt=i(Bt,2);e(yt),e(Ht),e(tt),st(()=>H(_t,t(h).description)),b("click",Bt,()=>V(t(h).id)),b("click",zt,()=>ja(t(h).id)),v(x,tt)}),v(a,n)};U(Ba,a=>{t(m).length===0?a(Na):a(Pa,!1)})}e(da),e(Tt);var va=i(Tt,2),Ua=i(va,2);e(ca),e(Qt);var Vt=i(Qt,2),ua=i(s(Vt),2),ma=s(ua);{var Oa=a=>{var n=Ce();mt(n,5,()=>t(O),bt,(l,x)=>{var h=ze(),tt=s(h),rt=s(tt,!0);e(tt);var _t=i(tt,2),dt=s(_t),nt=i(dt,2);e(_t),e(h),st(()=>H(rt,t(x).description)),b("click",dt,()=>ft(gt+`/workspace/hazard/mitigation?hazardID=${t(o)}&mitigationID=${t(x).id}`)),b("click",nt,()=>Aa(t(x).id)),v(l,h)}),e(n),v(a,n)},qa=a=>{var n=De();v(a,n)};U(ma,a=>{t(O).length?a(Oa):a(qa,!1)})}var ba=i(ma,2),Wa=i(ba,2);e(ua),e(Vt);var Xt=i(Vt,2),pa=i(s(Xt),2),fa=s(pa);{var Fa=a=>{var n=$e(),l=i(s(n));mt(l,5,()=>t(d).hazardImpacts,bt,(x,h)=>{var tt=Mt();const rt=ea(()=>B().find(nt=>nt.id===t(h).impactID));var _t=lt(tt);{var dt=nt=>{var It=Se(),wt=s(It),Ht=s(wt,!0);e(wt);var yt=i(wt),Bt=s(yt,!0);e(yt);var zt=i(yt),vt=s(zt,!0);e(zt);var et=i(zt),Yt=s(et);{var Zt=kt=>{var xt=Me();const aa=ea(()=>ia.assess(k[t(h).likelihood],k[t(rt).severity]));var Xa=s(xt);e(xt),st(()=>{Ut(xt,1,`badge ${_[t(aa).score]} me-2`),H(Xa,`${t(aa).rating??""} (${t(aa).score??""})`)}),v(kt,xt)},ta=kt=>{var xt=Le();v(kt,xt)};U(Yt,kt=>{t(h).likelihood?kt(Zt):kt(ta,!1)})}e(et);var Nt=i(et),Ct=s(Nt),pt=s(Ct),Pt=i(pt,2),Va=i(Pt,2);e(Ct),e(Nt),e(It),st(()=>{H(Ht,t(rt).description),H(Bt,t(h).likelihood),H(vt,t(rt).severity)}),b("click",pt,()=>{r(it,t(h).impactID),r(W,!0),console.log("Editing impact:",t(h).impactID)}),b("click",Pt,()=>{r(q,t(h).impactID),r($,!0)}),b("click",Va,()=>Ea(t(h).impactID)),v(nt,It)};U(_t,nt=>{t(rt)&&nt(dt)})}v(x,tt)}),e(l),e(n),v(a,n)},Ga=a=>{var n=Ee();v(a,n)};U(fa,a=>{var n,l;(l=(n=t(d))==null?void 0:n.hazardImpacts)!=null&&l.length?a(Fa):a(Ga,!1)})}var ga=i(fa,2),Ja=i(ga,2);e(pa),e(Xt);var ha=i(Xt,2),_a=i(ha,2);ce(_a,{get show(){return t(T)},get impacts(){return t(K)},get search(){return t(P)},set search(a){r(P,a)},$$events:{link:Ra,close:()=>r(T,!1)},$$legacy:!0});var ya=i(_a,2);be(ya,{get show(){return t(R)},get causes(){return t(Q)},get search(){return t(y)},set search(a){r(y,a)},$$events:{link:Ft,close:()=>r(R,!1)},$$legacy:!0});var ka=i(ya,2);ie(ka,{get show(){return t(c)},get mitigations(){return t(j)},get search(){return t(g)},set search(a){r(g,a)},$$events:{link:$a,close:()=>r(c,!1)},$$legacy:!0});var xa=i(ka,2);{var Ka=a=>{he(a,{get hazardID(){return t(o)},get impactID(){return t(q)},$$events:{save:()=>r($,!1),cancel:()=>r($,!1)}})};U(xa,a=>{t($)&&t(q)&&a(Ka)})}var Qa=i(xa,2);{var Ta=a=>{ke(a,{get impactID(){return t(it)},$$events:{save:()=>r(W,!1),cancel:()=>r(W,!1)}})};U(Qa,a=>{t(W)&&t(it)&&a(Ta)})}e(Jt),b("click",na,at),Et(la,()=>t(A),a=>r(A,a)),b("click",va,Y),b("click",Ua,()=>r(R,!0)),b("click",ba,Z),b("click",Wa,()=>r(c,!0)),b("click",ga,ht),b("click",Ja,()=>r(T,!0)),b("click",ha,Ha),v(ot,Jt),$t(),z()}export{os as component};
