import{f as y,e as k,a as B,r as C}from"../chunks/Cg9Xl0Sa.js";import"../chunks/CfKYgX-v.js";import{p as E,o as Y,t as j,d as t,a as q,s as c,c as m,e as d,m as _,g as F,r as l,n as G}from"../chunks/B56XX5F_.js";import{s as z}from"../chunks/BqzG54jq.js";import{b as H}from"../chunks/Dx0qbBmv.js";import{i as J}from"../chunks/CpnGeK5l.js";import{p as v}from"../chunks/CJnYkIW-.js";import{p as K}from"../chunks/CO5lv_UP.js";import{m as w,c as L}from"../chunks/iOF0ue_n.js";import{g as p,b as u}from"../chunks/C4YJHUZg.js";var N=y('<main class="container py-4"><button class="btn btn-link mb-3">‚Üê Back</button> <h1 class="mb-4"> </h1> <div class="mb-3"><label for="mitigationDescription" class="form-label">Mitigation Description</label> <textarea id="mitigationDescription" class="form-control" rows="3" placeholder="e.g. Add human review step"></textarea> <div class="form-text">A mitigation is an action or control that reduces the likelihood or impact of a hazard or cause.</div></div> <button class="btn btn-success"> </button></main>');function ta(M,S){E(S,!1);let r=null,o=null,i=_(null),n=_("");Y(()=>{if(r=v.url.searchParams.get("hazardID"),o=v.url.searchParams.get("causeID"),d(i,v.url.searchParams.get("mitigationID")),!r&&!o&&(alert("You must specify either a hazard or cause."),p(u+"/workspace")),t(i)){const e=F(w).find(a=>a.id===t(i));e&&d(n,e.description)}});function I(){o?p(u+`/workspace/hazard/cause?hazardID=${r}&causeID=${o}`):r?p(u+`/workspace/hazard?id=${r}`):p(u+"/workspace")}function $(){w.update(e=>{if(t(i))return e.map(a=>a.id===t(i)?{...a,description:t(n)}:a);{const a=e.length+1,s=`M${String(a).padStart(2,"0")}`;return d(i,s),[...e,{id:s,description:t(n)}]}}),t(i)&&(o?L.update(e=>e.map(a=>{var s;return a.id===o&&!((s=a.mitigationIds)!=null&&s.includes(t(i)))?{...a,mitigationIds:[...a.mitigationIds||[],t(i)]}:a})):r&&K.update(e=>({...e,hazards:e.hazards.map(a=>{var s;return a.id===r&&!((s=a.mitigationIds)!=null&&s.includes(t(i)))?{...a,mitigationIds:[...a.mitigationIds||[],t(i)]}:a})}))),I()}J();var f=N(),x=m(f),g=c(x,2),A=m(g,!0);l(g);var h=c(g,2),D=c(m(h),2);C(D),G(2),l(h);var b=c(h,2),P=m(b,!0);l(b),l(f),j(()=>{z(A,t(i)?"Edit Mitigation":"Add Mitigation"),z(P,t(i)?"Save Changes":"Save Mitigation")}),k("click",x,I),H(D,()=>t(n),e=>d(n,e)),k("click",b,$),B(M,f),q()}export{ta as component};
