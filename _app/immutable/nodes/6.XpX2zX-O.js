import{f as x,e as p,a as g,r as gt,c as vt}from"../chunks/Cg9Xl0Sa.js";import"../chunks/CfKYgX-v.js";import{p as bt,o as ht,l as H,b as _t,t as F,d as t,a as kt,s as n,c,e,m as l,g as G,r,n as xt,f as Mt,h as $t}from"../chunks/B56XX5F_.js";import{s as L}from"../chunks/BqzG54jq.js";import{i as J}from"../chunks/247NCbUc.js";import{e as It,i as wt}from"../chunks/DLiX6WjV.js";import{b as zt}from"../chunks/Dx0qbBmv.js";import{i as Ct}from"../chunks/CpnGeK5l.js";import{s as Dt,a as yt}from"../chunks/B45zb-iJ.js";import{p as K}from"../chunks/CJnYkIW-.js";import{g as S,b as A}from"../chunks/C4YJHUZg.js";import{p as Lt}from"../chunks/CO5lv_UP.js";import{c as k,m as St}from"../chunks/iOF0ue_n.js";import{L as At}from"../chunks/e-nR0wtI.js";var Et=x('<li class="list-group-item d-flex justify-content-between align-items-center"> <button class="btn btn-sm btn-outline-danger">Remove</button></li>'),Nt=x('<ul class="list-group mb-2"></ul>'),Bt=x('<p class="text-muted">No mitigations linked yet.</p>'),Pt=x('<main class="container py-4"><button class="btn btn-link mb-3">‚Üê Back to Hazard</button> <h1 class="mb-4"> </h1> <div class="mb-3"><label for="causeDescription" class="form-label">Cause Description</label> <textarea id="causeDescription" class="form-control" rows="3" placeholder="Describe a factor that could lead to this hazard"></textarea> <div class="form-text">A cause is a factor or condition that could contribute to the hazard occurring.</div></div> <div class="mb-4"><label class="form-label">Linked Mitigations</label> <!></div> <div class="mb-3"><button class="btn btn-secondary me-2">+ Add New Mitigation</button> <button class="btn btn-outline-primary">Link Existing Mitigation</button></div> <button class="btn btn-success"> </button> <!></main>');function Xt(O,Q){bt(Q,!1);const[T,U]=Dt(),v=()=>yt(St,"$mitigations",T),M=l(),E=l();let u=null,s=l(null),m=l(""),o=l([]),b=l(!1),h=l("");ht(()=>{if(u=K.url.searchParams.get("hazardID"),e(s,K.url.searchParams.get("causeID")),t(s)){const a=G(k).find(i=>i.id===t(s));a&&(e(m,a.description),e(o,a.mitigationIds||[]))}});function V(){S(A+`/workspace/hazard?id=${u}`)}function W(){k.update(a=>a.map(i=>i.id===t(s)?{...i,description:t(m),mitigationIds:t(o)}:i))}function X(){const a=G(k).length+1;e(s,`C${String(a).padStart(2,"0")}`),k.update(i=>[...i,{id:t(s),description:t(m),mitigationIds:t(o)}]),Lt.update(i=>({...i,hazards:i.hazards.map(d=>d.id===u?{...d,causeIds:[...d.causeIds||[],t(s)]}:d)}))}function N(){t(s)?W():X()}function Y(){N(),S(A+`/workspace/hazard?id=${u}`)}function Z(a){e(o,[...t(o),a])}function tt(a){e(o,t(o).filter(i=>i!==a))}function at(){N(),S(A+`/workspace/hazard/mitigation?causeID=${t(s)}&hazardID=${u}`)}function it(a){Z(a.detail),e(b,!1)}H(()=>v(),()=>{e(M,v())}),H(()=>(t(M),t(h),t(o)),()=>{e(E,t(M).filter(a=>a.description.toLowerCase().includes(t(h).toLowerCase())&&!t(o).includes(a.id)))}),_t(),Ct();var $=Pt(),B=c($),I=n(B,2),et=c(I,!0);r(I);var w=n(I,2),P=n(c(w),2);gt(P),xt(2),r(w);var z=n(w,2),st=n(c(z),2);{var ot=a=>{var i=Nt();It(i,5,()=>t(o),wt,(d,D)=>{var j=vt(),dt=Mt(j);{var ut=y=>{var f=Et();const mt=$t(()=>v().find(pt=>pt.id===t(D)));var q=c(f),ft=n(q);r(f),F(()=>L(q,`${t(mt).description??""} `)),p("click",ft,()=>tt(t(D))),g(y,f)};J(dt,y=>{v().find(f=>f.id===t(D))&&y(ut)})}g(d,j)}),r(i),g(a,i)},nt=a=>{var i=Bt();g(a,i)};J(st,a=>{t(o).length?a(ot):a(nt,!1)})}r(z);var C=n(z,2),R=c(C),rt=n(R,2);r(C);var _=n(C,2),ct=c(_,!0);r(_);var lt=n(_,2);At(lt,{get show(){return t(b)},get mitigations(){return t(E)},get search(){return t(h)},set search(a){e(h,a)},$$events:{link:it,close:()=>e(b,!1)},$$legacy:!0}),r($),F(()=>{L(et,t(s)?"Edit Cause":"Add Cause"),L(ct,t(s)?"Save Changes":"Save Cause")}),p("click",B,V),zt(P,()=>t(m),a=>e(m,a)),p("click",R,at),p("click",rt,()=>e(b,!0)),p("click",_,Y),g(O,$),kt(),U()}export{Xt as component};
