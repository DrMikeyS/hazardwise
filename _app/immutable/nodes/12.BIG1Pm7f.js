import{f as M,e as f,a as p,r as xt,c as kt}from"../chunks/ChAviyHt.js";import{i as Mt}from"../chunks/qNE941fV.js";import{a as It}from"../chunks/ccL3LbYJ.js";import{p as $t,l as K,h as wt,t as O,g as t,a as zt,s as n,d as e,m as l,c,i as Q,r,n as Ct,f as Dt,j as T}from"../chunks/CXmlZRuw.js";import{s as x}from"../chunks/BUZbKzbf.js";import{i as U}from"../chunks/AaKCM-in.js";import{e as yt,i as Lt}from"../chunks/DqM6bYLX.js";import{b as St}from"../chunks/DSrdwlJO.js";import{s as At,a as Et}from"../chunks/BORQ0yCD.js";import{p as V}from"../chunks/CiXDgTiF.js";import{g as N}from"../chunks/aGD26JgA.js";import{b as j}from"../chunks/CFYPu0N-.js";import{p as Nt}from"../chunks/nz0IzRFZ.js";import{c as k}from"../chunks/BLf9jbdx.js";import{m as jt,a as qt}from"../chunks/C9Et0Kmr.js";import{L as Bt}from"../chunks/CRQ7niQd.js";var Pt=M('<li class="list-group-item d-flex justify-content-between align-items-center"><div><div> </div> <div class="text-muted small"> </div></div> <button class="btn btn-sm btn-outline-danger">Remove</button></li>'),Rt=M('<ul class="list-group mb-2"></ul>'),Ht=M('<p class="text-muted">No mitigations linked yet.</p>'),Ft=M('<main class="container py-4"><button class="btn btn-link mb-3">‚Üê Back to Hazard</button> <h1 class="mb-4"> </h1> <div class="mb-3"><label for="causeDescription" class="form-label">Cause Description</label> <div class="form-text mb-2">Describe a factor or condition that could lead to this hazard.</div> <textarea id="causeDescription" class="form-control" rows="3"></textarea> <div class="form-text">A cause is a factor or condition that could contribute to the hazard occurring. e.g. "A drink is spilled leaving a puddle of liquid that goes unnoticed."</div></div> <div class="mb-4"><p class="form-label mb-1">Linked Mitigations</p> <!></div> <div class="mb-3"><button class="btn btn-secondary me-2">+ Add New Mitigation</button> <button class="btn btn-outline-primary">Link Existing Mitigation</button></div> <button class="btn btn-success"> </button> <!></main>');function sa(W,X){$t(X,!1);const[Y,Z]=At(),g=()=>Et(jt,"$mitigations",Y),I=l(),q=l();let u=null,s=l(null),m=l(""),o=l([]),b=l(!1),_=l("");It(()=>{if(u=V.url.searchParams.get("hazardID"),e(s,V.url.searchParams.get("causeID")),t(s)){const a=Q(k).find(i=>i.id===t(s));a&&(e(m,a.description),e(o,a.mitigationIds||[]))}});function tt(){N(j+`/workspace/hazard?id=${u}`)}function at(){k.update(a=>a.map(i=>i.id===t(s)?{...i,description:t(m),mitigationIds:t(o)}:i))}function it(){const a=Q(k).length+1;e(s,`C${String(a).padStart(2,"0")}`),k.update(i=>[...i,{id:t(s),description:t(m),mitigationIds:t(o)}]),Nt.update(i=>({...i,hazards:i.hazards.map(d=>d.id===u?{...d,causeIds:[...d.causeIds||[],t(s)]}:d)}))}function B(){t(s)?at():it()}function et(){B(),N(j+`/workspace/hazard?id=${u}`)}function st(a){e(o,[...t(o),a])}function ot(a){e(o,t(o).filter(i=>i!==a))}function nt(){B(),N(j+`/workspace/hazard/mitigation?causeID=${t(s)}&hazardID=${u}`)}function rt(a){st(a.detail),e(b,!1)}K(()=>g(),()=>{e(I,g())}),K(()=>(t(I),t(_),t(o)),()=>{e(q,t(I).filter(a=>a.description.toLowerCase().includes(t(_).toLowerCase())&&!t(o).includes(a.id)))}),wt(),Mt();var $=Ft(),P=c($),w=n(P,2),ct=c(w,!0);r(w);var z=n(w,2),R=n(c(z),4);xt(R),Ct(2),r(z);var C=n(z,2),lt=n(c(C),2);{var dt=a=>{var i=Rt();yt(i,5,()=>t(o),Lt,(d,y)=>{var F=kt(),pt=Dt(F);{var gt=L=>{var v=Pt();const G=T(()=>g().find(E=>E.id===t(y)));var S=c(v),A=c(S),bt=c(A,!0);r(A);var J=n(A,2),_t=c(J,!0);r(J),r(S);var ht=n(S,2);r(v),O(E=>{x(bt,t(G).description),x(_t,E)},[()=>qt(t(G).implementationClass)],T),f("click",ht,()=>ot(t(y))),p(L,v)};U(pt,L=>{g().find(v=>v.id===t(y))&&L(gt)})}p(d,F)}),r(i),p(a,i)},ut=a=>{var i=Ht();p(a,i)};U(lt,a=>{t(o).length?a(dt):a(ut,!1)})}r(C);var D=n(C,2),H=c(D),mt=n(H,2);r(D);var h=n(D,2),vt=c(h,!0);r(h);var ft=n(h,2);Bt(ft,{get show(){return t(b)},get mitigations(){return t(q)},get search(){return t(_)},set search(a){e(_,a)},$$events:{link:rt,close:()=>e(b,!1)},$$legacy:!0}),r($),O(()=>{x(ct,t(s)?"Edit Cause":"Add Cause"),x(vt,t(s)?"Save Changes":"Save Cause")}),f("click",P,tt),St(R,()=>t(m),a=>e(m,a)),f("click",H,nt),f("click",mt,()=>e(b,!0)),f("click",h,et),p(W,$),zt(),Z()}export{sa as component};
