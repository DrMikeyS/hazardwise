import{f as Z,e as P,a as aa,r as ta}from"../chunks/ChAviyHt.js";import{i as ia}from"../chunks/qNE941fV.js";import{a as ea}from"../chunks/ccL3LbYJ.js";import{p as sa,m as C,t as ra,g as i,a as oa,s,c as r,d,i as na,r as o,n as la}from"../chunks/CXmlZRuw.js";import{s as u}from"../chunks/BUZbKzbf.js";import{r as y}from"../chunks/BcXK0Cv5.js";import{b as ma,c as F}from"../chunks/DSrdwlJO.js";import{p as k}from"../chunks/CiXDgTiF.js";import{p as ca}from"../chunks/nz0IzRFZ.js";import{c as da}from"../chunks/BLf9jbdx.js";import{M as n,m as $,n as pa,b as B,c as H}from"../chunks/C9Et0Kmr.js";import{g as I}from"../chunks/aGD26JgA.js";import{b}from"../chunks/CFYPu0N-.js";var ua=Z('<main class="container py-4"><button class="btn btn-link mb-3">‚Üê Back</button> <h1 class="mb-4"> </h1> <div class="mb-3"><label for="mitigationDescription" class="form-label">Mitigation Description</label> <div class="form-text mb-2">Describe the control or action that reduces the likelihood or impact of harm.</div> <textarea id="mitigationDescription" class="form-control" rows="3"></textarea> <div class="form-text">A mitigation is an action or control that reduces the likelihood or impact of a hazard or cause. e.g. "Staff are advised not to carry uncovered drinks to prevent spills.".</div></div> <fieldset class="mb-4"><legend class="col-form-label pt-0">Who implements this mitigation?</legend> <div class="form-text mb-2">Choose who is responsible for putting this mitigation in place.</div> <div class="form-check mb-2"><input id="implementationClassOrganisation" class="form-check-input" type="radio" name="implementationClass"/> <label class="form-check-label" for="implementationClassOrganisation"> </label> <div class="form-text"> </div></div> <div class="form-check"><input id="implementationClassManufacturer" class="form-check-input" type="radio" name="implementationClass"/> <label class="form-check-label" for="implementationClassManufacturer"> </label> <div class="form-text"> </div></div></fieldset> <button class="btn btn-success"> </button></main>');function Ca(W,X){sa(X,!1);const R=[];let m=null,p=null,e=C(null),f=C(""),c=C(n.ORGANISATION);ea(()=>{if(m=k.url.searchParams.get("hazardID"),p=k.url.searchParams.get("causeID"),d(e,k.url.searchParams.get("mitigationID")),!m&&!p&&(alert("You must specify either a hazard or cause."),I(b+"/workspace/hazards")),i(e)){const t=na($).find(a=>a.id===i(e));t&&(d(f,t.description),d(c,pa(t.implementationClass)))}});function E(){p?I(b+`/workspace/hazard/cause?hazardID=${m}&causeID=${p}`):m?I(b+`/workspace/hazard?id=${m}`):I(b+"/workspace/hazards")}function Y(){$.update(t=>{if(i(e))return t.map(a=>a.id===i(e)?{...a,description:i(f),implementationClass:i(c)}:a);{const a=t.length+1,l=`M${String(a).padStart(2,"0")}`;return d(e,l),[...t,{id:l,description:i(f),implementationClass:i(c)}]}}),i(e)&&(p?da.update(t=>t.map(a=>{var l;return a.id===p&&!((l=a.mitigationIds)!=null&&l.includes(i(e)))?{...a,mitigationIds:[...a.mitigationIds||[],i(e)]}:a})):m&&ca.update(t=>({...t,hazards:t.hazards.map(a=>{var l;return a.id===m&&!((l=a.mitigationIds)!=null&&l.includes(i(e)))?{...a,mitigationIds:[...a.mitigationIds||[],i(e)]}:a})}))),E()}ia();var h=ua(),S=r(h),_=s(S,2),j=r(_,!0);o(_);var A=s(_,2),z=s(r(A),4);ta(z),la(2),o(A);var N=s(A,2),T=s(r(N),4),v=r(T);y(v);var D,M=s(v,2),q=r(M,!0);o(M);var U=s(M,2),J=r(U,!0);o(U),o(T);var G=s(T,2),g=r(G);y(g);var w,x=s(g,2),K=r(x,!0);o(x);var L=s(x,2),Q=r(L,!0);o(L),o(G),o(N);var O=s(N,2),V=r(O,!0);o(O),o(h),ra(()=>{u(j,i(e)?"Edit Mitigation":"Add Mitigation"),D!==(D=n.ORGANISATION)&&(v.value=(v.__value=n.ORGANISATION)??""),u(q,B[n.ORGANISATION]),u(J,H[n.ORGANISATION]),w!==(w=n.MANUFACTURER)&&(g.value=(g.__value=n.MANUFACTURER)??""),u(K,B[n.MANUFACTURER]),u(Q,H[n.MANUFACTURER]),u(V,i(e)?"Save Changes":"Save Mitigation")}),P("click",S,E),ma(z,()=>i(f),t=>d(f,t)),F(R,[],v,()=>(n.ORGANISATION,i(c)),t=>d(c,t)),F(R,[],g,()=>(n.MANUFACTURER,i(c)),t=>d(c,t)),P("click",O,Y),aa(W,h),oa()}export{Ca as component};
