import{f as I,r as _t,e as T,a as v,c as gt}from"../chunks/ChAviyHt.js";import{i as st}from"../chunks/qNE941fV.js";import{p as nt,m as D,i as ht,d as m,s as o,f as Y,c as e,r as a,t as j,g as t,o as It,a as rt,l as xt,h as yt}from"../chunks/CXmlZRuw.js";import{s as C}from"../chunks/BUZbKzbf.js";import{i as X}from"../chunks/AaKCM-in.js";import{e as et,i as it}from"../chunks/DqM6bYLX.js";import{r as At,s as Mt,a as Nt}from"../chunks/BcXK0Cv5.js";import{s as Ct,a as Tt}from"../chunks/BORQ0yCD.js";import{M as h,m as S,n as Et,b as ot,g as kt}from"../chunks/C9Et0Kmr.js";import{c as Ot,a as Rt}from"../chunks/ccL3LbYJ.js";import{b as Dt}from"../chunks/DXL4SEhS.js";import{b as St}from"../chunks/DSrdwlJO.js";import{p as Gt}from"../chunks/CJX2CLUN.js";var wt=I('<div class="modal-backdrop fade show"></div> <div class="modal fade show" tabindex="-1" style="display: block;"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><h5 class="modal-title">Edit Mitigation</h5> <button type="button" class="btn-close" aria-label="Close"></button></div> <div class="modal-body"><div class="mb-3"><label for="mitigationDescription" class="form-label">Description</label> <textarea id="mitigationDescription" class="form-control" rows="3"></textarea></div> <div class="mb-3"><label for="mitigationImplementationClass" class="form-label">Implementation Class</label> <select id="mitigationImplementationClass" class="form-select"><option> </option><option> </option></select></div></div> <div class="modal-footer"><button type="button" class="btn btn-secondary">Cancel</button> <button type="button" class="btn btn-primary">Save</button></div></div></div></div>',1);function Ut(q,G){nt(G,!1);let x=Gt(G,"mitigationID",8);const w=Ot();let l=D(""),c=D(h.ORGANISATION);Rt(()=>{const n=ht(S).find(d=>d.id===x());n&&(m(l,n.description),m(c,Et(n.implementationClass))),console.log(`Editing mitigation: ${x()}`,n)});function H(){S.update(n=>n.map(d=>d.id===x()?{...d,description:t(l),implementationClass:t(c)}:d)),w("save",{mitigationID:x(),description:t(l),implementationClass:t(c)})}function p(){w("cancel")}st();var y=wt(),U=o(Y(y),2),$=e(U),L=e($),E=e(L),J=o(e(E),2);a(E);var A=o(E,2),b=e(A),F=o(e(b),2);_t(F),a(b);var B=o(b,2),k=o(e(B),2);j(()=>{t(c),It(()=>{})});var u=e(k),P={},i=e(u,!0);a(u);var s=o(u),r={},f=e(s,!0);a(s),a(k),a(B),a(A);var _=o(A,2),M=e(_),O=o(M,2);a(_),a(L),a($),a(U),j(()=>{P!==(P=h.ORGANISATION)&&(u.value=(u.__value=h.ORGANISATION)??""),C(i,ot[h.ORGANISATION]),r!==(r=h.MANUFACTURER)&&(s.value=(s.__value=h.MANUFACTURER)??""),C(f,ot[h.MANUFACTURER])}),T("click",J,p),St(F,()=>t(l),n=>m(l,n)),Dt(k,()=>t(c),n=>m(c,n)),T("click",M,p),T("click",O,H),v(q,y),rt()}var $t=I('<p class="text-muted">No mitigations added.</p>'),Lt=I('<tr><td> </td><td> </td><td class="text-center"><input type="checkbox"/></td><td><button class="btn btn-sm btn-outline-primary me-2">Edit</button> <button type="button" class="btn btn-sm btn-outline-danger">Remove</button></td></tr>'),Ft=I('<table class="table table-striped table-bordered"><thead class="table-light"><tr><th scope="col">ID</th><th scope="col">Description</th><th scope="col" class="text-center">Implemented</th><th scope="col">Actions</th></tr></thead><tbody></tbody></table>'),Bt=I('<p class="text-muted">No mitigations in this class yet.</p>'),Pt=I('<section class="mb-4"><h2 class="h5 mb-1"> </h2> <p class="text-muted small mb-2"> </p> <!></section>'),zt=I('<div class="container py-4"><h1 class="mb-4">Mitigations</h1> <p class="text-muted mb-4">Mitigations are grouped by who is responsible for implementing them.</p> <!></div> <!>',1);function ea(q,G){nt(G,!1);const[x,w]=Ct(),l=()=>Tt(S,"$mitigations",x),c=D();function H(i){confirm("Are you sure you want to remove this mitigation?")&&S.update(s=>s.filter(r=>r.id!==i))}let p=D(!1),y=D(null);function U(i){m(y,i),m(p,!0)}function $(){m(p,!1)}function L(){m(p,!1)}function E(i,s){S.update(r=>r.map(f=>f.id===i?{...f,implemented:s}:f))}function J(i,s){const r=s.currentTarget;r&&E(i,r.checked)}xt(()=>l(),()=>{m(c,kt(l()))}),yt(),st();var A=zt(),b=Y(A),F=o(e(b),4);{var B=i=>{var s=$t();v(i,s)},k=i=>{var s=gt(),r=Y(s);et(r,1,()=>t(c),it,(f,_)=>{var M=Pt(),O=e(M),n=e(O,!0);a(O);var d=o(O,2),lt=e(d,!0);a(d);var ct=o(d,2);{var dt=N=>{var R=Ft(),Z=o(e(R));et(Z,5,()=>t(_).items,it,(vt,g)=>{var K=Lt(),Q=e(K),pt=e(Q,!0);a(Q);var V=o(Q),bt=e(V,!0);a(V);var W=o(V),z=e(W);At(z),a(W);var tt=o(W),at=e(tt),ut=o(at,2);a(tt),a(K),j(()=>{C(pt,t(g).id),C(bt,t(g).description),Mt(z,t(g).implemented),Nt(z,"aria-label",`Mark ${t(g).id??""} implemented`)}),T("change",z,ft=>J(t(g).id,ft)),T("click",at,()=>U(t(g).id)),T("click",ut,()=>H(t(g).id)),v(vt,K)}),a(Z),a(R),v(N,R)},mt=N=>{var R=Bt();v(N,R)};X(ct,N=>{t(_).items.length?N(dt):N(mt,!1)})}a(M),j(()=>{C(n,t(_).label),C(lt,t(_).helpText)}),v(f,M)}),v(i,s)};X(F,i=>{l().length?i(k,!1):i(B)})}a(b);var u=o(b,2);{var P=i=>{Ut(i,{get mitigationID(){return t(y)},$$events:{save:$,cancel:L}})};X(u,i=>{t(p)&&t(y)&&i(P)})}v(q,A),rt(),w()}export{ea as component};
