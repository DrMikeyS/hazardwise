import{f as z,a as w}from"../chunks/DKjMb6sX.js";import"../chunks/BoZ7937s.js";import{o as pe}from"../chunks/DS4b0SzP.js";import{p as me,l as I,d as ue,t as S,g as e,a as ve,s as n,c as o,b as u,m as g,r as i}from"../chunks/T6ZX_lWH.js";import{s as b}from"../chunks/DLR2iFmf.js";import{i as be}from"../chunks/CZsKGD6Q.js";import{e as Y,i as F}from"../chunks/BT3w6O0N.js";import{r as G}from"../chunks/jmCHuThu.js";import{s as B}from"../chunks/DIRYb9ye.js";import{e as J,r as he}from"../chunks/CXugo_-b.js";import{c as K}from"../chunks/i5w7oQmI.js";import{b as ge,a as N}from"../chunks/CY8UTbGA.js";import{i as fe}from"../chunks/DIFYUOde.js";import{g as ye}from"../chunks/BwX_BP9M.js";import{p as Q}from"../chunks/DBzgh-MV.js";import{p as _e}from"../chunks/DF6sdC5p.js";import{i as T}from"../chunks/BqKrn31S.js";import{g as V}from"../chunks/Btyk992k.js";import{b as X}from"../chunks/Cm3tyc6z.js";import{D as Z}from"../chunks/YXMk_YDc.js";var xe=z('<tr><td class="text-nowrap"><input type="radio" name="severity" class="form-check-input me-2"/> <strong> </strong></td><td> </td></tr>'),ke=z('<tr><td class="text-nowrap"><input type="radio" name="likelihood" class="form-check-input me-2"/> <strong> </strong></td><td> </td></tr>'),we=z('<div class="mt-4"><h5>Calculated Risk Rating</h5> <div> </div> <div class="form-text"> </div></div>'),Ie=z('<main class="container py-4"><button class="btn btn-link mb-3">‚Üê Back to Hazard</button> <h1 class="mb-4"> </h1> <div class="mb-3"><label for="impactDescription" class="form-label">Impact Description</label> <textarea id="impactDescription" class="form-control" rows="3" placeholder="e.g. Incorrect clinical advice leads to unsafe prescription"></textarea></div> <h5 class="mt-4">Severity</h5> <p>How badly could someone (or some people) be hurt if this impact occured?</p> <table class="table table-bordered align-middle"><tbody></tbody></table> <h5 class="mt-4">Likelihood</h5> <p>How likely is it that this impact will occur <strong>due to this hazard</strong> and <strong>with the planned mitigations</strong> in place?</p> <table class="table table-bordered align-middle"><tbody></tbody></table> <!> <button class="btn btn-success mt-4"> </button></main>');function Ge(ee,te){me(te,!1);const x=g(),v=g(),ae=[],re=[];let k=null,c=g(null),f=g(""),l=g(""),d=g("");const ie=[{value:"Catastrophic",label:"Catastrophic",description:"Death; permanent life-changing incapacity; or severe injury/incapacity from which recovery is not expected in the short term. [Multiple patients]",class:"table-danger"},{value:"Major",label:"Major",description:"[Single patient:] death or permanent life-changing incapacity not recoverable. [Multiple patients:] severe injury/incapacity recoverable; severe psychological trauma.",class:"table-warning"},{value:"Considerable",label:"Considerable",description:"Severe injury/incapacity from which recovery is expected in the short term; severe psychological trauma. [Single or multiple patients]",class:"table-info"},{value:"Significant",label:"Significant",description:"Minor injury or injuries from which recovery is not expected in the short term; significant psychological trauma. [Single or multiple patients]",class:""},{value:"Minor",label:"Minor",description:"Minor injury from which recovery is expected in the short term; minor psychological upset or inconvenience. [Single or multiple patients]",class:"table-secondary text-white"}],se=[{value:"Almost Certain",label:"Almost Certain",description:"Expected to occur frequently",class:"table-danger"},{value:"Likely",label:"Likely",description:"Will probably occur occasionally",class:"table-warning"},{value:"Possible",label:"Possible",description:"Could occur but uncommon",class:"table-info"},{value:"Unlikely",label:"Unlikely",description:"Rare but possible",class:""},{value:"Rare",label:"Rare",description:"Exceptional circumstances only",class:"table-secondary text-white"}],oe={1:"bg-success text-white",2:"bg-info text-dark",3:"bg-warning text-dark",4:"bg-danger text-white",5:"bg-danger text-white"},h={Catastrophic:5,Major:4,Considerable:3,Significant:2,Minor:1,"Almost Certain":5,Likely:4,Possible:3,Unlikely:2,Rare:1};pe(()=>{if(k=Q.url.searchParams.get("hazardID"),u(c,Q.url.searchParams.get("impactID")),k||(alert("You must specify a hazard."),V(X+"/workspace/hazards")),e(c)){const a=ye(T).find(t=>t.id===e(c));a&&(u(f,a.description),u(l,a.severity),u(d,a.likelihood))}});function E(){V(X+`/workspace/hazard?id=${k}`)}function le(){if(!e(l)||!e(d)){alert("Please select both severity and likelihood.");return}e(x),e(v).rating,T.update(a=>{if(e(c))return a.map(t=>t.id===e(c)?{...t,description:e(f),severity:e(l)}:t);{const t=a.length+1,r=`I${String(t).padStart(2,"0")}`;return u(c,r),[...a,{id:r,description:e(f),severity:e(l)}]}}),e(c)&&_e.update(a=>({...a,hazards:a.hazards.map(t=>{var s;if(t.id!==k)return t;const r=(s=t.hazardImpacts)==null?void 0:s.some(m=>m.impactID===e(c)),p={impactID:e(c),likelihood:e(d)};return{...t,hazardImpacts:r?t.hazardImpacts.map(m=>m.impactID===e(c)?p:m):[...t.hazardImpacts||[],p]}})})),E()}I(()=>(e(l),e(d)),()=>{u(x,(h[e(l)]||0)*(h[e(d)]||0))}),I(()=>(e(l),e(d),Z),()=>{u(v,h[e(l)]&&h[e(d)]?Z.assess(h[e(d)],h[e(l)]):null)}),I(()=>(e(l),e(d)),()=>{console.log("Levels",e(l),e(d),h)}),I(()=>(e(v),e(x)),()=>{console.log("Risk assessment:",e(v),e(x))}),ue(),fe();var C=Ie(),H=o(C),D=n(H,2),ne=o(D,!0);i(D);var M=n(D,2),U=n(o(M),2);he(U),i(M);var j=n(M,6),O=o(j);Y(O,5,()=>ie,F,(a,t)=>{var r=xe(),p=o(r),s=o(p);G(s);var m,y=n(s,2),$=o(y,!0);i(y),i(p);var _=n(p),A=o(_,!0);i(_),i(r),S(()=>{B(r,1,K(e(t).class)),m!==(m=e(t).value)&&(s.value=(s.__value=e(t).value)??""),b($,e(t).label),b(A,e(t).description)}),N(ae,[],s,()=>(e(t).value,e(l)),L=>u(l,L)),w(a,r)}),i(O),i(j);var R=n(j,6),q=o(R);Y(q,5,()=>se,F,(a,t)=>{var r=ke(),p=o(r),s=o(p);G(s);var m,y=n(s,2),$=o(y,!0);i(y),i(p);var _=n(p),A=o(_,!0);i(_),i(r),S(()=>{B(r,1,K(e(t).class)),m!==(m=e(t).value)&&(s.value=(s.__value=e(t).value)??""),b($,e(t).label),b(A,e(t).description)}),N(re,[],s,()=>(e(t).value,e(d)),L=>u(d,L)),w(a,r)}),i(q),i(R);var W=n(R,2);{var ce=a=>{var t=we(),r=n(o(t),2),p=o(r);i(r);var s=n(r,2),m=o(s,!0);i(s),i(t),S(()=>{B(r,1,`badge ${oe[e(v).score]}`),b(p,`${e(v).rating??""} (${e(v).score??""} pts)`),b(m,e(v).definition)}),w(a,t)};be(W,a=>{e(v)&&a(ce)})}var P=n(W,2),de=o(P,!0);i(P),i(C),S(()=>{b(ne,e(c)?"Edit Impact":"Add Impact"),b(de,e(c)?"Save Impact":"Add Impact")}),J("click",H,E),ge(U,()=>e(f),a=>u(f,a)),J("click",P,le),w(ee,C),ve()}export{Ge as component};
