import{f as x,e as p,a as g,r as pt,c as gt}from"../chunks/Bgrwumxt.js";import"../chunks/DhE9Dmh7.js";import{p as vt,o as bt,l as q,b as ht,t as H,d as t,a as _t,s as n,c,e,m as l,g as F,r,n as kt,f as xt,h as Mt}from"../chunks/BITUO3ds.js";import{s as L}from"../chunks/OzCop-J-.js";import{i as G}from"../chunks/BH6CHFx5.js";import{e as $t,i as It}from"../chunks/BVTScTTu.js";import{b as wt}from"../chunks/D4bh5b3p.js";import{i as zt}from"../chunks/DYcduxHM.js";import{s as Ct,a as Dt}from"../chunks/BxqH717Y.js";import{p as J}from"../chunks/zUhEKtR7.js";import{g as S}from"../chunks/CvsrO4Zi.js";import{p as yt}from"../chunks/KPTtVCqv.js";import{c as k,m as Lt}from"../chunks/CBoHnL1w.js";import{L as St}from"../chunks/DBq5NF87.js";var At=x('<li class="list-group-item d-flex justify-content-between align-items-center"> <button class="btn btn-sm btn-outline-danger">Remove</button></li>'),Et=x('<ul class="list-group mb-2"></ul>'),Nt=x('<p class="text-muted">No mitigations linked yet.</p>'),Bt=x('<main class="container py-4"><button class="btn btn-link mb-3">‚Üê Back to Hazard</button> <h1 class="mb-4"> </h1> <div class="mb-3"><label for="causeDescription" class="form-label">Cause Description</label> <textarea id="causeDescription" class="form-control" rows="3" placeholder="Describe a factor that could lead to this hazard"></textarea> <div class="form-text">A cause is a factor or condition that could contribute to the hazard occurring.</div></div> <div class="mb-4"><label class="form-label">Linked Mitigations</label> <!></div> <div class="mb-3"><button class="btn btn-secondary me-2">+ Add New Mitigation</button> <button class="btn btn-outline-primary">Link Existing Mitigation</button></div> <button class="btn btn-success"> </button> <!></main>');function Wt(K,O){vt(O,!1);const[Q,T]=Ct(),v=()=>Dt(Lt,"$mitigations",Q),M=l(),A=l();let u=null,s=l(null),m=l(""),o=l([]),b=l(!1),h=l("");bt(()=>{if(u=J.url.searchParams.get("hazardID"),e(s,J.url.searchParams.get("causeID")),t(s)){const a=F(k).find(i=>i.id===t(s));a&&(e(m,a.description),e(o,a.mitigationIds||[]))}});function U(){S(`/workspace/hazard?id=${u}`)}function V(){k.update(a=>a.map(i=>i.id===t(s)?{...i,description:t(m),mitigationIds:t(o)}:i))}function W(){const a=F(k).length+1;e(s,`C${String(a).padStart(2,"0")}`),k.update(i=>[...i,{id:t(s),description:t(m),mitigationIds:t(o)}]),yt.update(i=>({...i,hazards:i.hazards.map(d=>d.id===u?{...d,causeIds:[...d.causeIds||[],t(s)]}:d)}))}function E(){t(s)?V():W()}function X(){E(),S(`/workspace/hazard?id=${u}`)}function Y(a){e(o,[...t(o),a])}function Z(a){e(o,t(o).filter(i=>i!==a))}function tt(){E(),S(`/workspace/hazard/mitigation?causeID=${t(s)}&hazardID=${u}`)}function at(a){Y(a.detail),e(b,!1)}q(()=>v(),()=>{e(M,v())}),q(()=>(t(M),t(h),t(o)),()=>{e(A,t(M).filter(a=>a.description.toLowerCase().includes(t(h).toLowerCase())&&!t(o).includes(a.id)))}),ht(),zt();var $=Bt(),N=c($),I=n(N,2),it=c(I,!0);r(I);var w=n(I,2),B=n(c(w),2);pt(B),kt(2),r(w);var z=n(w,2),et=n(c(z),2);{var st=a=>{var i=Et();$t(i,5,()=>t(o),It,(d,D)=>{var R=gt(),lt=xt(R);{var dt=y=>{var f=At();const ut=Mt(()=>v().find(ft=>ft.id===t(D)));var j=c(f),mt=n(j);r(f),H(()=>L(j,`${t(ut).description??""} `)),p("click",mt,()=>Z(t(D))),g(y,f)};G(lt,y=>{v().find(f=>f.id===t(D))&&y(dt)})}g(d,R)}),r(i),g(a,i)},ot=a=>{var i=Nt();g(a,i)};G(et,a=>{t(o).length?a(st):a(ot,!1)})}r(z);var C=n(z,2),P=c(C),nt=n(P,2);r(C);var _=n(C,2),rt=c(_,!0);r(_);var ct=n(_,2);St(ct,{get show(){return t(b)},get mitigations(){return t(A)},get search(){return t(h)},set search(a){e(h,a)},$$events:{link:at,close:()=>e(b,!1)},$$legacy:!0}),r($),H(()=>{L(it,t(s)?"Edit Cause":"Add Cause"),L(rt,t(s)?"Save Changes":"Save Cause")}),p("click",N,U),wt(B,()=>t(m),a=>e(m,a)),p("click",P,tt),p("click",nt,()=>e(b,!0)),p("click",_,X),g(K,$),_t(),T()}export{Wt as component};
