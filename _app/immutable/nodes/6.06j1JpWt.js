import{f as x,e as p,a as g,r as gt,c as vt}from"../chunks/BigRneoS.js";import"../chunks/DhYZTW0n.js";import{p as bt,o as ht,l as H,b as _t,t as F,d as t,a as kt,s as r,c,e,m as l,g as G,r as n,n as xt,f as Mt,h as $t}from"../chunks/Dp4XvV4q.js";import{s as L}from"../chunks/R0xEnjdg.js";import{i as J}from"../chunks/DUX-zM3N.js";import{e as It,i as wt}from"../chunks/U-ZPKxaM.js";import{b as zt}from"../chunks/BcZp7PTO.js";import{i as Ct}from"../chunks/DeQT2YmM.js";import{s as Dt,a as yt}from"../chunks/BFbgREId.js";import{p as K}from"../chunks/CMg1VSn_.js";import{g as S}from"../chunks/CC_0R2Wk.js";import{b as A}from"../chunks/DoDhfopV.js";import{p as Lt}from"../chunks/B4aGxuZ6.js";import{c as k}from"../chunks/mw76NlSF.js";import{m as St}from"../chunks/B7G4vysy.js";import{L as At}from"../chunks/C9APO4es.js";var Et=x('<li class="list-group-item d-flex justify-content-between align-items-center"> <button class="btn btn-sm btn-outline-danger">Remove</button></li>'),Nt=x('<ul class="list-group mb-2"></ul>'),Bt=x('<p class="text-muted">No mitigations linked yet.</p>'),Pt=x('<main class="container py-4"><button class="btn btn-link mb-3">‚Üê Back to Hazard</button> <h1 class="mb-4"> </h1> <div class="mb-3"><label for="causeDescription" class="form-label">Cause Description</label> <textarea id="causeDescription" class="form-control" rows="3" placeholder="Describe a factor that could lead to this hazard"></textarea> <div class="form-text">A cause is a factor or condition that could contribute to the hazard occurring.</div></div> <div class="mb-4"><label class="form-label">Linked Mitigations</label> <!></div> <div class="mb-3"><button class="btn btn-secondary me-2">+ Add New Mitigation</button> <button class="btn btn-outline-primary">Link Existing Mitigation</button></div> <button class="btn btn-success"> </button> <!></main>');function Zt(O,Q){bt(Q,!1);const[T,U]=Dt(),v=()=>yt(St,"$mitigations",T),M=l(),E=l();let u=null,s=l(null),m=l(""),o=l([]),b=l(!1),h=l("");ht(()=>{if(u=K.url.searchParams.get("hazardID"),e(s,K.url.searchParams.get("causeID")),t(s)){const a=G(k).find(i=>i.id===t(s));a&&(e(m,a.description),e(o,a.mitigationIds||[]))}});function V(){S(A+`/workspace/hazard?id=${u}`)}function W(){k.update(a=>a.map(i=>i.id===t(s)?{...i,description:t(m),mitigationIds:t(o)}:i))}function X(){const a=G(k).length+1;e(s,`C${String(a).padStart(2,"0")}`),k.update(i=>[...i,{id:t(s),description:t(m),mitigationIds:t(o)}]),Lt.update(i=>({...i,hazards:i.hazards.map(d=>d.id===u?{...d,causeIds:[...d.causeIds||[],t(s)]}:d)}))}function N(){t(s)?W():X()}function Y(){N(),S(A+`/workspace/hazard?id=${u}`)}function Z(a){e(o,[...t(o),a])}function tt(a){e(o,t(o).filter(i=>i!==a))}function at(){N(),S(A+`/workspace/hazard/mitigation?causeID=${t(s)}&hazardID=${u}`)}function it(a){Z(a.detail),e(b,!1)}H(()=>v(),()=>{e(M,v())}),H(()=>(t(M),t(h),t(o)),()=>{e(E,t(M).filter(a=>a.description.toLowerCase().includes(t(h).toLowerCase())&&!t(o).includes(a.id)))}),_t(),Ct();var $=Pt(),B=c($),I=r(B,2),et=c(I,!0);n(I);var w=r(I,2),P=r(c(w),2);gt(P),xt(2),n(w);var z=r(w,2),st=r(c(z),2);{var ot=a=>{var i=Nt();It(i,5,()=>t(o),wt,(d,D)=>{var j=vt(),dt=Mt(j);{var ut=y=>{var f=Et();const mt=$t(()=>v().find(pt=>pt.id===t(D)));var q=c(f),ft=r(q);n(f),F(()=>L(q,`${t(mt).description??""} `)),p("click",ft,()=>tt(t(D))),g(y,f)};J(dt,y=>{v().find(f=>f.id===t(D))&&y(ut)})}g(d,j)}),n(i),g(a,i)},rt=a=>{var i=Bt();g(a,i)};J(st,a=>{t(o).length?a(ot):a(rt,!1)})}n(z);var C=r(z,2),R=c(C),nt=r(R,2);n(C);var _=r(C,2),ct=c(_,!0);n(_);var lt=r(_,2);At(lt,{get show(){return t(b)},get mitigations(){return t(E)},get search(){return t(h)},set search(a){e(h,a)},$$events:{link:it,close:()=>e(b,!1)},$$legacy:!0}),n($),F(()=>{L(et,t(s)?"Edit Cause":"Add Cause"),L(ct,t(s)?"Save Changes":"Save Cause")}),p("click",B,V),zt(P,()=>t(m),a=>e(m,a)),p("click",R,at),p("click",nt,()=>e(b,!0)),p("click",_,Y),g(O,$),kt(),U()}export{Zt as component};
