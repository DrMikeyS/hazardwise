import{f as d,a as o,e as G,c as U,t as Qt}from"../chunks/ChAviyHt.js";import{i as St}from"../chunks/qNE941fV.js";import{p as Tt,l as Vt,h as Wt,a as Xt,d as Zt,m as ta,s as i,c as s,g as t,r as a,f as C,n as aa,t as N,j as M}from"../chunks/CXmlZRuw.js";import{s as c}from"../chunks/BUZbKzbf.js";import{i as h}from"../chunks/AaKCM-in.js";import{e as D,i as L}from"../chunks/DqM6bYLX.js";import{s as ra}from"../chunks/DxgXjCp7.js";import{a as Y,s as sa}from"../chunks/BORQ0yCD.js";import{p as ft}from"../chunks/nz0IzRFZ.js";import{c as ea}from"../chunks/BLf9jbdx.js";import{i as oa}from"../chunks/DFSBX4kA.js";import{m as ia,a as ut}from"../chunks/C9Et0Kmr.js";import{g as gt}from"../chunks/aGD26JgA.js";import{b as ht}from"../chunks/CFYPu0N-.js";import{H as at}from"../chunks/BW6px5DQ.js";import{a as da}from"../chunks/D-dackkR.js";var na=d('<div class="alert alert-info" role="alert">You have not added any hazards yet. Get started by adding your first one.</div> <button class="btn btn-primary mt-3">Add First Hazard</button>',1),va=d('<span class="badge ms-2"> </span>'),la=d('<span> </span> <span class="text-muted small"> </span> ',1),ma=d('<span class="text-muted">None</span>'),ca=d("<tr><td> </td><td><!></td></tr>"),pa=d('<div class="table-responsive mb-3"><table class="table table-sm table-bordered"><thead><tr><th style="width:50%">Cause</th><th style="width:50%">Mitigations</th></tr></thead><tbody></tbody></table></div>'),_a=d('<p class="text-muted mb-3">No causes added.</p>'),ba=d("<tr><td> </td><td> </td></tr>"),fa=d('<div class="table-responsive mb-3"><table class="table table-sm table-bordered"><thead><tr><th>Mitigation</th><th>Implementation Class</th></tr></thead><tbody></tbody></table></div>'),ua=d('<p class="text-muted">No mitigations added.</p>'),ga=d("<em>Not assessed</em>"),ha=d("<tr><td> </td><td><!></td></tr>"),ya=d('<div class="table-responsive mb-3"><table class="table table-sm table-bordered"><thead><tr><th style="width:70%">Description</th><th style="width:30%">Risk Rating</th></tr></thead><tbody></tbody></table></div>'),xa=d('<p class="text-muted mb-3">No impacts added.</p>'),za=d('<details class="card mb-3"><summary class="card-header d-flex justify-content-between align-items-center"><div><strong> </strong> <!></div> <div class="d-flex align-items-center"><div class="btn-group"><button type="button" class="btn btn-sm btn-outline-secondary">Edit</button> <button type="button" class="btn btn-sm btn-outline-danger">Remove</button></div> <small class="ms-3 text-muted">â–¼</small></div></summary> <div class="card-body"><h5 class="card-title">Causes</h5> <!> <h5 class="card-title">Hazard-Level Mitigations</h5> <!> <h5 class="card-title">Impacts</h5> <!></div></details>'),ka=d('<button class="btn btn-primary mb-3">Add Another Hazard</button> <!>',1),Ia=d('<main class="container py-4"><h1 class="mb-3">Hazard Log</h1> <!></main>');function Ya(yt,xt){Tt(xt,!1);const[q,zt]=sa(),B=()=>Y(ft,"$project",q),rt=()=>Y(oa,"$impacts",q),st=()=>Y(ea,"$causes",q),E=()=>Y(ia,"$mitigations",q),J=ta();function et(p){return(p.hazardImpacts||[]).map(n=>{const x=rt().find(P=>P.id===n.impactID),O=da(n);return{hi:n,core:x,risk:O}}).filter(n=>!!n.core)}console.log("project:",B()),console.log("impacts:",rt());function ot(){gt(ht+"/workspace/hazard")}function kt(p){confirm("Are you sure you want to remove this hazard?")&&ft.update(n=>({...n,hazards:n.hazards.filter(x=>x.id!==p)}))}Vt(()=>B(),()=>{Zt(J,B().hazards||[])}),Wt(),St();var K=Ia(),It=i(s(K),2);{var Ht=p=>{var n=na(),x=i(C(n),2);G("click",x,ot),o(p,n)},wt=p=>{var n=ka(),x=C(n),O=i(x,2);D(O,1,()=>t(J),L,(P,v)=>{var Q=za(),S=s(Q),T=s(S),V=s(T),Rt=s(V,!0);a(V);var it=i(V),jt=i(it);{var Ct=e=>{var r=va(),_=s(r);a(r),N((b,I)=>{ra(r,`background-color: ${b??""};`),c(_,`Risk: ${I??""}`)},[()=>at.getHighestRisk(t(v)).color,()=>at.getHighestRisk(t(v)).rating],M),o(e,r)};h(jt,e=>{at.getHighestRisk(t(v)).rating&&e(Ct)})}a(T);var dt=i(T,2),nt=s(dt),vt=s(nt),Nt=i(vt,2);a(nt),aa(2),a(dt),a(S);var lt=i(S,2),mt=i(s(lt),2);{var At=e=>{var r=pa(),_=s(r),b=i(s(_));D(b,5,()=>t(v).causeIds,L,(I,z)=>{var H=U(),A=C(H);{var w=m=>{var l=ca();const f=M(()=>st().find(k=>k.id===t(z)));var y=s(l),$=s(y,!0);a(y);var R=i(y),u=s(R);{var g=k=>{var j=U(),Gt=C(j);D(Gt,1,()=>t(f).mitigationIds,L,(Ut,pt,Yt)=>{var _t=U(),Bt=C(_t);{var Jt=W=>{var F=la();const bt=M(()=>E().find(tt=>tt.id===t(pt)));var X=C(F),Kt=s(X,!0);a(X);var Z=i(X,2),Ot=s(Z);a(Z);var Pt=i(Z,1,!0);N(tt=>{c(Kt,t(bt).description),c(Ot,`(${tt??""})`),c(Pt,Yt<t(f).mitigationIds.length-1?", ":"")},[()=>ut(t(bt).implementationClass)],M),o(W,F)};h(Bt,W=>{E().find(F=>F.id===t(pt))&&W(Jt)})}o(Ut,_t)}),o(k,j)},Ft=k=>{var j=ma();o(k,j)};h(u,k=>{var j;(j=t(f).mitigationIds)!=null&&j.length?k(g):k(Ft,!1)})}a(R),a(l),N(()=>c($,t(f).description)),o(m,l)};h(A,m=>{st().find(l=>l.id===t(z))&&m(w)})}o(I,H)}),a(b),a(_),a(r),o(e,r)},Mt=e=>{var r=_a();o(e,r)};h(mt,e=>{var r;(r=t(v).causeIds)!=null&&r.length?e(At):e(Mt,!1)})}var ct=i(mt,4);{var $t=e=>{var r=fa(),_=s(r),b=i(s(_));D(b,5,()=>t(v).mitigationIds,L,(I,z)=>{var H=U(),A=C(H);{var w=m=>{var l=ba();const f=M(()=>E().find(g=>g.id===t(z)));var y=s(l),$=s(y,!0);a(y);var R=i(y),u=s(R,!0);a(R),a(l),N(g=>{c($,t(f).description),c(u,g)},[()=>ut(t(f).implementationClass)],M),o(m,l)};h(A,m=>{E().find(l=>l.id===t(z))&&m(w)})}o(I,H)}),a(b),a(_),a(r),o(e,r)},Dt=e=>{var r=ua();o(e,r)};h(ct,e=>{var r;(r=t(v).mitigationIds)!=null&&r.length?e($t):e(Dt,!1)})}var Lt=i(ct,4);{var qt=e=>{var r=ya(),_=s(r),b=i(s(_));D(b,5,()=>et(t(v)),L,(I,z)=>{let H=()=>t(z).core,A=()=>t(z).risk;var w=ha(),m=s(w),l=s(m,!0);a(m);var f=i(m),y=s(f);{var $=u=>{var g=Qt();N(()=>c(g,A().rating)),o(u,g)},R=u=>{var g=ga();o(u,g)};h(y,u=>{A()?u($):u(R,!1)})}a(f),a(w),N(()=>c(l,H().description)),o(I,w)}),a(b),a(_),a(r),o(e,r)},Et=e=>{var r=xa();o(e,r)};h(Lt,e=>{et(t(v)).length?e(qt):e(Et,!1)})}a(lt),a(Q),N(()=>{c(Rt,t(v).id),c(it,`: ${t(v).description??""} `)}),G("click",vt,()=>gt(ht+`/workspace/hazard?id=${t(v).id}`)),G("click",Nt,()=>kt(t(v).id)),o(P,Q)}),G("click",x,ot),o(p,n)};h(It,p=>{t(J).length===0?p(Ht):p(wt,!1)})}a(K),o(yt,K),Xt(),zt()}export{Ya as component};
