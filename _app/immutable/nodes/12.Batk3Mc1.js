import{f as x,e as p,a as g,r as gt,c as vt}from"../chunks/DA4zlYT6.js";import{i as bt}from"../chunks/Bv-0c6t3.js";import{a as ht}from"../chunks/BOTc4DbH.js";import{p as _t,l as H,h as kt,t as F,g as t,a as xt,s as n,d as e,m as c,c as l,i as G,r,n as Mt,f as $t,j as It}from"../chunks/Dh6mP1wG.js";import{s as L}from"../chunks/DvvhDkJs.js";import{i as J}from"../chunks/BEFexrlf.js";import{e as wt,i as zt}from"../chunks/BhqyOs_e.js";import{b as Ct}from"../chunks/ByEUdlhv.js";import{s as Dt,a as yt}from"../chunks/BqAN62AK.js";import{p as K}from"../chunks/D0ugsqkT.js";import{g as S}from"../chunks/BsPCPuPp.js";import{b as A}from"../chunks/C9Pz-73a.js";import{p as Lt}from"../chunks/CD6oGcH5.js";import{c as k}from"../chunks/SP2ZwDGS.js";import{m as St}from"../chunks/5zig9VdD.js";import{L as At}from"../chunks/B50egxx4.js";var Et=x('<li class="list-group-item d-flex justify-content-between align-items-center"> <button class="btn btn-sm btn-outline-danger">Remove</button></li>'),Nt=x('<ul class="list-group mb-2"></ul>'),jt=x('<p class="text-muted">No mitigations linked yet.</p>'),qt=x('<main class="container py-4"><button class="btn btn-link mb-3">‚Üê Back to Hazard</button> <h1 class="mb-4"> </h1> <div class="mb-3"><label for="causeDescription" class="form-label">Cause Description</label> <div class="form-text mb-2">Describe a factor or condition that could lead to this hazard.</div> <textarea id="causeDescription" class="form-control" rows="3"></textarea> <div class="form-text">A cause is a factor or condition that could contribute to the hazard occurring. e.g. "A drink is spilled leaving a puddle of liquid that goes unnoticed."</div></div> <div class="mb-4"><label class="form-label">Linked Mitigations</label> <!></div> <div class="mb-3"><button class="btn btn-secondary me-2">+ Add New Mitigation</button> <button class="btn btn-outline-primary">Link Existing Mitigation</button></div> <button class="btn btn-success"> </button> <!></main>');function Zt(O,Q){_t(Q,!1);const[T,U]=Dt(),v=()=>yt(St,"$mitigations",T),M=c(),E=c();let u=null,s=c(null),m=c(""),o=c([]),b=c(!1),h=c("");ht(()=>{if(u=K.url.searchParams.get("hazardID"),e(s,K.url.searchParams.get("causeID")),t(s)){const a=G(k).find(i=>i.id===t(s));a&&(e(m,a.description),e(o,a.mitigationIds||[]))}});function V(){S(A+`/workspace/hazard?id=${u}`)}function W(){k.update(a=>a.map(i=>i.id===t(s)?{...i,description:t(m),mitigationIds:t(o)}:i))}function X(){const a=G(k).length+1;e(s,`C${String(a).padStart(2,"0")}`),k.update(i=>[...i,{id:t(s),description:t(m),mitigationIds:t(o)}]),Lt.update(i=>({...i,hazards:i.hazards.map(d=>d.id===u?{...d,causeIds:[...d.causeIds||[],t(s)]}:d)}))}function N(){t(s)?W():X()}function Y(){N(),S(A+`/workspace/hazard?id=${u}`)}function Z(a){e(o,[...t(o),a])}function tt(a){e(o,t(o).filter(i=>i!==a))}function at(){N(),S(A+`/workspace/hazard/mitigation?causeID=${t(s)}&hazardID=${u}`)}function it(a){Z(a.detail),e(b,!1)}H(()=>v(),()=>{e(M,v())}),H(()=>(t(M),t(h),t(o)),()=>{e(E,t(M).filter(a=>a.description.toLowerCase().includes(t(h).toLowerCase())&&!t(o).includes(a.id)))}),kt(),bt();var $=qt(),j=l($),I=n(j,2),et=l(I,!0);r(I);var w=n(I,2),q=n(l(w),4);gt(q),Mt(2),r(w);var z=n(w,2),st=n(l(z),2);{var ot=a=>{var i=Nt();wt(i,5,()=>t(o),zt,(d,D)=>{var P=vt(),dt=$t(P);{var ut=y=>{var f=Et();const mt=It(()=>v().find(pt=>pt.id===t(D)));var R=l(f),ft=n(R);r(f),F(()=>L(R,`${t(mt).description??""} `)),p("click",ft,()=>tt(t(D))),g(y,f)};J(dt,y=>{v().find(f=>f.id===t(D))&&y(ut)})}g(d,P)}),r(i),g(a,i)},nt=a=>{var i=jt();g(a,i)};J(st,a=>{t(o).length?a(ot):a(nt,!1)})}r(z);var C=n(z,2),B=l(C),rt=n(B,2);r(C);var _=n(C,2),ct=l(_,!0);r(_);var lt=n(_,2);At(lt,{get show(){return t(b)},get mitigations(){return t(E)},get search(){return t(h)},set search(a){e(h,a)},$$events:{link:it,close:()=>e(b,!1)},$$legacy:!0}),r($),F(()=>{L(et,t(s)?"Edit Cause":"Add Cause"),L(ct,t(s)?"Save Changes":"Save Cause")}),p("click",j,V),Ct(q,()=>t(m),a=>e(m,a)),p("click",B,at),p("click",rt,()=>e(b,!0)),p("click",_,Y),g(O,$),xt(),U()}export{Zt as component};
