import{g as n}from"./Doyjl1dZ.js";import{p as r}from"./DEmP0uQ1.js";import{c as f}from"./FIlIACWG.js";import{m as v}from"./BEGveUOT.js";import{i as g}from"./Azzcam0s.js";import{D as U}from"./BEWyR57g.js";class j{static generateNewId(e){const i=e.map(a=>parseInt(a.id,10)).filter(a=>!isNaN(a));return String((i.length?Math.max(...i):0)+1)}static saveNewHazard(e){const i=n(r),a=this.generateNewId(i.hazards||[]),t={id:a,description:e,causeIds:[],mitigationIds:[],impactIds:[]};return r.update(s=>({...s,hazards:[...s.hazards??[],t]})),{id:a,hazardObj:t}}static removeUnusedCauses(){const e=n(r),i=new Set(e.hazards.flatMap(a=>a.causeIds||[]));f.update(a=>a.filter(t=>i.has(t.id)))}static removeUnusedMitigations(){const e=n(r),i=new Set([...e.hazards.flatMap(a=>a.mitigationIds||[]),...e.hazards.flatMap(a=>a.causeIds||[]).flatMap(a=>{var t;return((t=n(f).find(s=>s.id===a))==null?void 0:t.mitigationIds)||[]})]);v.update(a=>a.filter(t=>i.has(t.id)))}static removeUnusedImpacts(){const e=n(r),i=new Set(e.hazards.flatMap(a=>a.impactIds||[]));g.update(a=>a.filter(t=>i.has(t.id)))}static removeImpact(e,i){return r.update(t=>({...t,hazards:t.hazards.map(s=>s.id===e?{...s,impactIds:(s.impactIds||[]).filter(d=>d!==i)}:s)})),n(r).hazards.find(t=>t.id===e)}static removeCause(e,i){return r.update(t=>({...t,hazards:t.hazards.map(s=>s.id===e?{...s,causeIds:(s.causeIds||[]).filter(d=>d!==i)}:s)})),this.removeUnusedCauses(),n(r).hazards.find(t=>t.id===e)}static removeHazardMitigation(e,i){return r.update(t=>({...t,hazards:t.hazards.map(s=>s.id===e?{...s,mitigationIds:(s.mitigationIds||[]).filter(d=>d!==i)}:s)})),n(r).hazards.find(t=>t.id===e)}static getHighestRisk(e){const i=n(g),a=e.hazardImpacts||[],t={Minor:1,Significant:2,Considerable:3,Major:4,Catastrophic:5,Rare:1,Unlikely:2,Possible:3,Likely:4,"Almost Certain":5},s=a.map(o=>{const{impactID:c,likelihood:u}=o;if(!u)return null;const p=i.find(M=>M.id===c);if(!p||!p.severity)return null;const m=t[p.severity],l=t[u];if(!m||!l)return null;const{score:h,rating:z}=U.assess(l,m);return{score:h,rating:z}}).filter(o=>!!o);if(!s.length)return{score:0,rating:"",color:""};const d=s.reduce((o,c)=>c.score>o.score?c:o),I={Acceptable:"#28a745",Undesirable:"#ffc107","Unacceptable Without Further Mitigation":"#dc3545",Unacceptable:"#dc3545"};return{score:d.score,rating:d.rating,color:I[d.rating]??"#6c757d"}}}export{j as H};
