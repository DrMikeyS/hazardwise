import{g as c}from"./D-P7AXKl.js";import{p as r}from"./Bu9f80X6.js";import{c as f}from"./CVsMCqo-.js";import{m as v}from"./HCEeGut2.js";import{i as g}from"./Bj2ds-qs.js";import{D as U}from"./CrXWVPai.js";class j{static generateNewId(s){const i=s.map(a=>parseInt(a.id,10)).filter(a=>!isNaN(a));return String((i.length?Math.max(...i):0)+1)}static saveNewHazard(s){const i=c(r),a=this.generateNewId(i.hazards||[]),t={id:a,description:s,causeIds:[],mitigationIds:[],impactIds:[]};return r.update(e=>({...e,hazards:[...e.hazards??[],t]})),{id:a,hazardObj:t}}static removeUnusedCauses(){const s=c(r),i=new Set(s.hazards.flatMap(a=>a.causeIds||[]));f.update(a=>a.filter(t=>i.has(t.id)))}static removeUnusedMitigations(){const s=c(r),i=new Set([...s.hazards.flatMap(a=>a.mitigationIds||[]),...s.hazards.flatMap(a=>a.causeIds||[]).flatMap(a=>{var t;return((t=c(f).find(e=>e.id===a))==null?void 0:t.mitigationIds)||[]})]);v.update(a=>a.filter(t=>i.has(t.id)))}static removeUnusedImpacts(){const s=c(r),i=new Set(s.hazards.flatMap(a=>a.impactIds||[]));g.update(a=>a.filter(t=>i.has(t.id)))}static removeImpact(s,i){return r.update(t=>({...t,hazards:t.hazards.map(e=>e.id===s?{...e,impactIds:(e.impactIds||[]).filter(d=>d!==i)}:e)})),c(r).hazards.find(t=>t.id===s)}static removeCause(s,i){return r.update(t=>({...t,hazards:t.hazards.map(e=>e.id===s?{...e,causeIds:(e.causeIds||[]).filter(d=>d!==i)}:e)})),this.removeUnusedCauses(),c(r).hazards.find(t=>t.id===s)}static removeHazardMitigation(s,i){return r.update(t=>({...t,hazards:t.hazards.map(e=>e.id===s?{...e,mitigationIds:(e.mitigationIds||[]).filter(d=>d!==i)}:e)})),c(r).hazards.find(t=>t.id===s)}static getHighestRisk(s){const i=c(g),a=s.hazardImpacts||[],t={Minor:1,Significant:2,Considerable:3,Major:4,Catastrophic:5,Rare:1,Unlikely:2,Possible:3,Likely:4,"Almost Certain":5},e=a.map(n=>{const{impactID:o,likelihood:u}=n;if(!u)return null;const p=i.find(M=>M.id===o);if(!p||!p.severity)return null;const l=t[p.severity],m=t[u];if(!l||!m)return null;const{score:I,rating:z}=U.assess(m,l);return{score:I,rating:z}}).filter(n=>!!n);if(!e.length)return{score:0,rating:"",color:""};const d=e.reduce((n,o)=>o.score>n.score?o:n),h={Acceptable:"#28a745",Undesirable:"#ffc107","Unacceptable Without Further Mitigation":"#dc3545",Unacceptable:"#dc3545"};return{score:d.score,rating:d.rating,color:h[d.rating]??"#6c757d"}}static getRiskColor(s){return{Acceptable:"#28a745",Undesirable:"#ffc107","Unacceptable Without Further Mitigation":"#dc3545",Unacceptable:"#dc3545"}[s]||"#6c757d"}}export{j as H};
