import{w as p}from"./CXmlZRuw.js";import{a as c}from"./Cz0CWeBA.js";const t=Object.freeze({ORGANISATION:"organisation",MANUFACTURER:"manufacturer"}),A=Object.freeze({[t.ORGANISATION]:"Implemented by your organisation",[t.MANUFACTURER]:"Implemented by the manufacturer"}),N=Object.freeze({[t.ORGANISATION]:"Use this for local controls such as training, policies, monitoring, and configuration decisions.",[t.MANUFACTURER]:"Use this for controls delivered by the supplier, such as product changes, bug fixes, or vendor-managed safeguards."});function I(e){return e===t.MANUFACTURER?t.MANUFACTURER:t.ORGANISATION}function O(e={}){return{...e,implementationClass:I(e.implementationClass)}}function m(e){return Array.isArray(e)?e.map(s=>O(s)):[]}function g(e){return A[I(e)]}function U(e){const s=m(e),n={[t.ORGANISATION]:[],[t.MANUFACTURER]:[]};for(const r of s)n[r.implementationClass].push(r);return[{key:t.ORGANISATION,label:A[t.ORGANISATION],helpText:N[t.ORGANISATION],items:n[t.ORGANISATION]},{key:t.MANUFACTURER,label:A[t.MANUFACTURER],helpText:N[t.MANUFACTURER],items:n[t.MANUFACTURER]}]}function R(e,s){const n=c.get(e);let r=s;if(n)try{r=JSON.parse(n)}catch{r=s}const a=i=>m(Array.isArray(i)?i:[]),o=p(a(r)),T=i=>o.set(a(i)),l=i=>o.update(u=>a(i(u)));return o.subscribe(i=>c.set(e,JSON.stringify(a(i)),{expires:7,sameSite:"strict",path:"/"})),{subscribe:o.subscribe,set:T,update:l}}const E=R("hazardwise-mitigations",[]);export{t as M,g as a,A as b,N as c,U as g,E as m,I as n};
